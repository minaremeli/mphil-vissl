INFO 2022-05-14 14:43:30,775 train.py:  94: Env set for rank: 0, dist_rank: 0
INFO 2022-05-14 14:43:30,777 env.py:  50: ARCH:	x86_64
INFO 2022-05-14 14:43:30,778 env.py:  50: BASH_ENV:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/init/bash
INFO 2022-05-14 14:43:30,779 env.py:  50: BASH_FUNC_ml%%:	() {  eval $($LMOD_DIR/ml_cmd "$@")
}
INFO 2022-05-14 14:43:30,780 env.py:  50: BASH_FUNC_module%%:	() {  eval $($LMOD_CMD bash "$@") && eval $(${LMOD_SETTARG_CMD:-:} -s sh)
}
INFO 2022-05-14 14:43:30,781 env.py:  50: CMAKE_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64
INFO 2022-05-14 14:43:30,783 env.py:  50: CMAKE_PREFIX_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0
INFO 2022-05-14 14:43:30,784 env.py:  50: COLUMNS:	202
INFO 2022-05-14 14:43:30,786 env.py:  50: CONDA_ACTIVATE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/etc/profile.d/conda.sh
INFO 2022-05-14 14:43:30,787 env.py:  50: CONDA_DEFAULT_ENV:	vissl_env
INFO 2022-05-14 14:43:30,789 env.py:  50: CONDA_EXE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin/conda
INFO 2022-05-14 14:43:30,791 env.py:  50: CONDA_PREFIX:	/home/mila/r/rajkuman/.conda/envs/vissl_env
INFO 2022-05-14 14:43:30,792 env.py:  50: CONDA_PROMPT_MODIFIER:	(vissl_env) 
INFO 2022-05-14 14:43:30,794 env.py:  50: CONDA_PYTHON_EXE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin/python
INFO 2022-05-14 14:43:30,795 env.py:  50: CONDA_SHLVL:	1
INFO 2022-05-14 14:43:30,796 env.py:  50: CPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/include
INFO 2022-05-14 14:43:30,797 env.py:  50: CSPYTHONPREFIXES:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3
INFO 2022-05-14 14:43:30,799 env.py:  50: CUDA_VISIBLE_DEVICES:	0
INFO 2022-05-14 14:43:30,800 env.py:  50: ENVIRONMENT:	BATCH
INFO 2022-05-14 14:43:30,802 env.py:  50: GPU_DEVICE_ORDINAL:	0
INFO 2022-05-14 14:43:30,803 env.py:  50: HOME:	/home/mila/r/rajkuman
INFO 2022-05-14 14:43:30,804 env.py:  50: HOSTNAME:	mila03
INFO 2022-05-14 14:43:30,806 env.py:  50: ID:	debian
INFO 2022-05-14 14:43:30,807 env.py:  50: JPY_API_TOKEN:	834ce4aa2de248308d2103afece2e12b
INFO 2022-05-14 14:43:30,809 env.py:  50: JUPYTERHUB_ACTIVITY_URL:	http://172.16.2.123:8081/hub/api/users/rajkuman/activity
INFO 2022-05-14 14:43:30,811 env.py:  50: JUPYTERHUB_API_TOKEN:	834ce4aa2de248308d2103afece2e12b
INFO 2022-05-14 14:43:30,813 env.py:  50: JUPYTERHUB_API_URL:	http://172.16.2.123:8081/hub/api
INFO 2022-05-14 14:43:30,814 env.py:  50: JUPYTERHUB_BASE_URL:	/
INFO 2022-05-14 14:43:30,816 env.py:  50: JUPYTERHUB_CLIENT_ID:	jupyterhub-user-rajkuman
INFO 2022-05-14 14:43:30,818 env.py:  50: JUPYTERHUB_HOST:	
INFO 2022-05-14 14:43:30,820 env.py:  50: JUPYTERHUB_OAUTH_CALLBACK_URL:	/user/rajkuman/oauth_callback
INFO 2022-05-14 14:43:30,821 env.py:  50: JUPYTERHUB_SERVER_NAME:	
INFO 2022-05-14 14:43:30,822 env.py:  50: JUPYTERHUB_SERVICE_PREFIX:	/user/rajkuman/
INFO 2022-05-14 14:43:30,824 env.py:  50: JUPYTERHUB_USER:	rajkuman
INFO 2022-05-14 14:43:30,825 env.py:  50: JUPYTER_SERVER_ROOT:	/home/mila/r/rajkuman
INFO 2022-05-14 14:43:30,826 env.py:  50: JUPYTER_SERVER_URL:	http://0.0.0.0:57133/user/rajkuman/
INFO 2022-05-14 14:43:30,828 env.py:  50: KERNEL_LAUNCH_TIMEOUT:	40
INFO 2022-05-14 14:43:30,829 env.py:  50: LANG:	en_US.UTF-8
INFO 2022-05-14 14:43:30,830 env.py:  50: LANGUAGE:	en_CA:en
INFO 2022-05-14 14:43:30,832 env.py:  50: LESSCLOSE:	/bin/lesspipe %s %s
INFO 2022-05-14 14:43:30,833 env.py:  50: LESSOPEN:	| /bin/lesspipe %s
INFO 2022-05-14 14:43:30,835 env.py:  50: LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib
INFO 2022-05-14 14:43:30,836 env.py:  50: LINES:	50
INFO 2022-05-14 14:43:30,838 env.py:  50: LMOD_CMD:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec/lmod
INFO 2022-05-14 14:43:30,839 env.py:  50: LMOD_DIR:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec
INFO 2022-05-14 14:43:30,841 env.py:  50: LMOD_PACKAGE_PATH:	/cvmfs/config.mila.quebec/etc/lmod/
INFO 2022-05-14 14:43:30,843 env.py:  50: LMOD_PKG:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod
INFO 2022-05-14 14:43:30,844 env.py:  50: LMOD_ROOT:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod
INFO 2022-05-14 14:43:30,845 env.py:  50: LMOD_SETTARG_FULL_SUPPORT:	no
INFO 2022-05-14 14:43:30,846 env.py:  50: LMOD_SYSTEM_DEFAULT_MODULES:	Mila:gcc/7.4.0
INFO 2022-05-14 14:43:30,847 env.py:  50: LMOD_VERSION:	8.3.17
INFO 2022-05-14 14:43:30,849 env.py:  50: LMOD_sys:	Linux
INFO 2022-05-14 14:43:30,850 env.py:  50: LOADEDMODULES:	Mila:gcc/7.4.0:anaconda/3
INFO 2022-05-14 14:43:30,851 env.py:  50: LOCAL_RANK:	0
INFO 2022-05-14 14:43:30,853 env.py:  50: LOGNAME:	rajkuman
INFO 2022-05-14 14:43:30,854 env.py:  50: LS_COLORS:	rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
INFO 2022-05-14 14:43:30,855 env.py:  50: MAIL:	/var/mail/rajkuman
INFO 2022-05-14 14:43:30,857 env.py:  50: MANPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/share/man:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/share/man:/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man::
INFO 2022-05-14 14:43:30,858 env.py:  50: MODULEPATH:	/cvmfs/config.mila.quebec/modules/Core:/cvmfs/config.mila.quebec/modules/Compiler:/cvmfs/config.mila.quebec/modules/Environments:/cvmfs/config.mila.quebec/modules/Cuda:/cvmfs/config.mila.quebec/modules/Pytorch:/cvmfs/config.mila.quebec/modules/Tensorflow
INFO 2022-05-14 14:43:30,860 env.py:  50: MODULEPATH_ROOT:	/cvmfs/config.mila.quebec/modules
INFO 2022-05-14 14:43:30,862 env.py:  50: MODULERCFILE:	/cvmfs/config.mila.quebec/etc/lmod/modulerc.lua
INFO 2022-05-14 14:43:30,863 env.py:  50: MODULESHOME:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod
INFO 2022-05-14 14:43:30,865 env.py:  50: OLDPWD:	/home/mila/r/rajkuman/mina/mphil-vissl/configs/config/my_configs
INFO 2022-05-14 14:43:30,866 env.py:  50: PATH:	/home/mila/r/rajkuman/.conda/envs/vissl_env/bin:/home/mila/r/rajkuman/.local/bin:/usr/local/cuda/bin:/opt/bin:/usr/local/cuda/bin:/opt/bin:/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/condabin:/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin:/opt/slurm/bin:/sbin:/bin:/usr/sbin:/usr/bin
INFO 2022-05-14 14:43:30,868 env.py:  50: PKG_CONFIG_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/pkgconfig
INFO 2022-05-14 14:43:30,869 env.py:  50: PROCESSOR_ARCHITECTURE:	amd64
INFO 2022-05-14 14:43:30,871 env.py:  50: PWD:	/home/mila/r/rajkuman/mina/mphil-vissl
INFO 2022-05-14 14:43:30,873 env.py:  50: PYTHONNOUSERSITE:	True
INFO 2022-05-14 14:43:30,874 env.py:  50: PYTHONPATH:	/cvmfs/config.mila.quebec/etc/python.d/3.7
INFO 2022-05-14 14:43:30,876 env.py:  50: PYXTERM_DIMENSIONS:	80x25
INFO 2022-05-14 14:43:30,878 env.py:  50: RANK:	0
INFO 2022-05-14 14:43:30,882 env.py:  50: ROCR_VISIBLE_DEVICES:	0
INFO 2022-05-14 14:43:30,883 env.py:  50: SACCT_FORMAT:	User,JobID,Jobname,partition,state,time,start,end,elapsed,nnodes,ncpus,reqmem,alloctres,nodelist,workdir
INFO 2022-05-14 14:43:30,885 env.py:  50: SCRATCH:	/network/scratch/r/rajkuman
INFO 2022-05-14 14:43:30,887 env.py:  50: SHELL:	/bin/bash
INFO 2022-05-14 14:43:30,888 env.py:  50: SHLVL:	3
INFO 2022-05-14 14:43:30,890 env.py:  50: SINFO_FORMAT:	%18N %.6D %.11T %.4c %.8z %.6m %.8d %.6w %.22f %80E
INFO 2022-05-14 14:43:30,892 env.py:  50: SLURMD_NODENAME:	mila03
INFO 2022-05-14 14:43:30,893 env.py:  50: SLURM_CLUSTER_NAME:	mila
INFO 2022-05-14 14:43:30,895 env.py:  50: SLURM_CONF:	/etc/slurm/slurm.conf
INFO 2022-05-14 14:43:30,896 env.py:  50: SLURM_CPUS_ON_NODE:	4
INFO 2022-05-14 14:43:30,897 env.py:  50: SLURM_CPUS_PER_TASK:	4
INFO 2022-05-14 14:43:30,899 env.py:  50: SLURM_EXPORT_ENV:	PATH,LANG,USER,HOME,SHELL,JUPYTERHUB_API_TOKEN,JPY_API_TOKEN,JUPYTERHUB_CLIENT_ID,JUPYTERHUB_HOST,JUPYTERHUB_OAUTH_CALLBACK_URL,JUPYTERHUB_USER,JUPYTERHUB_SERVER_NAME,JUPYTERHUB_API_URL,JUPYTERHUB_ACTIVITY_URL,JUPYTERHUB_BASE_URL,JUPYTERHUB_SERVICE_PREFIX
INFO 2022-05-14 14:43:30,900 env.py:  50: SLURM_GET_USER_ENV:	1
INFO 2022-05-14 14:43:30,902 env.py:  50: SLURM_GTIDS:	0
INFO 2022-05-14 14:43:30,904 env.py:  50: SLURM_JOBID:	1821459
INFO 2022-05-14 14:43:30,905 env.py:  50: SLURM_JOB_ACCOUNT:	mila
INFO 2022-05-14 14:43:30,907 env.py:  50: SLURM_JOB_CPUS_PER_NODE:	4
INFO 2022-05-14 14:43:30,908 env.py:  50: SLURM_JOB_GID:	1471600619
INFO 2022-05-14 14:43:30,910 env.py:  50: SLURM_JOB_GPUS:	7
INFO 2022-05-14 14:43:30,911 env.py:  50: SLURM_JOB_ID:	1821459
INFO 2022-05-14 14:43:30,912 env.py:  50: SLURM_JOB_NAME:	jupyterhub-rajkuman
INFO 2022-05-14 14:43:30,914 env.py:  50: SLURM_JOB_NODELIST:	mila03
INFO 2022-05-14 14:43:30,916 env.py:  50: SLURM_JOB_NUM_NODES:	1
INFO 2022-05-14 14:43:30,917 env.py:  50: SLURM_JOB_PARTITION:	unkillable
INFO 2022-05-14 14:43:30,919 env.py:  50: SLURM_JOB_QOS:	normal
INFO 2022-05-14 14:43:30,920 env.py:  50: SLURM_JOB_UID:	1471600619
INFO 2022-05-14 14:43:30,921 env.py:  50: SLURM_JOB_USER:	rajkuman
INFO 2022-05-14 14:43:30,923 env.py:  50: SLURM_LOCALID:	0
INFO 2022-05-14 14:43:30,924 env.py:  50: SLURM_MEM_PER_NODE:	24000
INFO 2022-05-14 14:43:30,926 env.py:  50: SLURM_NNODES:	1
INFO 2022-05-14 14:43:30,928 env.py:  50: SLURM_NODEID:	0
INFO 2022-05-14 14:43:30,929 env.py:  50: SLURM_NODELIST:	mila03
INFO 2022-05-14 14:43:30,930 env.py:  50: SLURM_NODE_ALIASES:	(null)
INFO 2022-05-14 14:43:30,931 env.py:  50: SLURM_NPROCS:	1
INFO 2022-05-14 14:43:30,933 env.py:  50: SLURM_NTASKS:	1
INFO 2022-05-14 14:43:30,935 env.py:  50: SLURM_PRIO_PROCESS:	0
INFO 2022-05-14 14:43:30,936 env.py:  50: SLURM_PROCID:	0
INFO 2022-05-14 14:43:30,938 env.py:  50: SLURM_SUBMIT_DIR:	/var/lib/jupyterhub
INFO 2022-05-14 14:43:30,939 env.py:  50: SLURM_SUBMIT_HOST:	jupyter
INFO 2022-05-14 14:43:30,940 env.py:  50: SLURM_TASKS_PER_NODE:	1
INFO 2022-05-14 14:43:30,943 env.py:  50: SLURM_TASK_PID:	55997
INFO 2022-05-14 14:43:30,944 env.py:  50: SLURM_TMPDIR:	/Tmp/slurm.1821459.0
INFO 2022-05-14 14:43:30,945 env.py:  50: SLURM_TOPOLOGY_ADDR:	mila03
INFO 2022-05-14 14:43:30,946 env.py:  50: SLURM_TOPOLOGY_ADDR_PATTERN:	node
INFO 2022-05-14 14:43:30,948 env.py:  50: SLURM_WORKING_CLUSTER:	mila:slurm:6817:9216:109
INFO 2022-05-14 14:43:30,949 env.py:  50: SQUEUE_FORMAT:	%.8i %.8u %.12P %.14j %.3t %16S %.10M %.5D %.4C %.10b %.7m %N (%r) %k
INFO 2022-05-14 14:43:30,950 env.py:  50: S_COLORS:	auto
INFO 2022-05-14 14:43:30,951 env.py:  50: TERM:	xterm
INFO 2022-05-14 14:43:30,952 env.py:  50: TMPDIR:	/tmp
INFO 2022-05-14 14:43:30,954 env.py:  50: USER:	rajkuman
INFO 2022-05-14 14:43:30,956 env.py:  50: WORLD_SIZE:	1
INFO 2022-05-14 14:43:30,956 env.py:  50: XDG_SESSION_ID:	c520
INFO 2022-05-14 14:43:30,957 env.py:  50: _:	/home/mila/r/rajkuman/.conda/envs/vissl_env/bin/python
INFO 2022-05-14 14:43:30,959 env.py:  50: _CE_CONDA:	
INFO 2022-05-14 14:43:30,960 env.py:  50: _CE_M:	
INFO 2022-05-14 14:43:30,961 env.py:  50: _LMFILES_:	/cvmfs/config.mila.quebec/modules/Core/Mila.lua:/cvmfs/config.mila.quebec/modules/Core/gcc/7.4.0.lua:/cvmfs/config.mila.quebec/modules/Core/anaconda/3.lua
INFO 2022-05-14 14:43:30,963 env.py:  50: _ModuleTable001_:	X01vZHVsZVRhYmxlXz17WyJNVHZlcnNpb24iXT0zLFsiY19yZWJ1aWxkVGltZSJdPWZhbHNlLFsiY19zaG9ydFRpbWUiXT1mYWxzZSxkZXB0aFQ9e30sZmFtaWx5PXt9LG1UPXtNaWxhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL01pbGEubHVhIixbImZ1bGxOYW1lIl09Ik1pbGEiLFsibG9hZE9yZGVyIl09MSxwcm9wVD17bG1vZD17WyJzdGlja3kiXT0xLH0sfSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJNaWxhIix9LGFuYWNvbmRhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL2FuYWNvbmRhLzMubHVhIixbImZ1bGxOYW1lIl09ImFuYWNvbmRh
INFO 2022-05-14 14:43:30,964 env.py:  50: _ModuleTable002_:	LzMiLFsibG9hZE9yZGVyIl09Myxwcm9wVD17fSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJhbmFjb25kYS8zIix9LGdjYz17WyJmbiJdPSIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29yZS9nY2MvNy40LjAubHVhIixbImZ1bGxOYW1lIl09ImdjYy83LjQuMCIsWyJsb2FkT3JkZXIiXT0yLHByb3BUPXtsbW9kPXtbInN0aWNreSJdPTEsfSx9LFsic3RhY2tEZXB0aCJdPTAsWyJzdGF0dXMiXT0iYWN0aXZlIixbInVzZXJOYW1lIl09ImdjYy83LjQuMCIsfSx9LG1wYXRoQT17Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Nv
INFO 2022-05-14 14:43:30,966 env.py:  50: _ModuleTable003_:	bXBpbGVyIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Vudmlyb25tZW50cyIsIi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9DdWRhIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL1B5dG9yY2giLCIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvVGVuc29yZmxvdyIsfSxbInN5c3RlbUJhc2VNUEFUSCJdPSIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29yZTovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29tcGlsZXI6L2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Vudmlyb25tZW50czovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ3VkYTovY3Zt
INFO 2022-05-14 14:43:30,967 env.py:  50: _ModuleTable004_:	ZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvUHl0b3JjaDovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvVGVuc29yZmxvdyIsfQ==
INFO 2022-05-14 14:43:30,969 env.py:  50: _ModuleTable_Sz_:	4
INFO 2022-05-14 14:43:30,970 env.py:  50: __Init_Default_Modules:	1
INFO 2022-05-14 14:43:30,971 env.py:  50: __LMOD_REF_COUNT_CMAKE_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:1
INFO 2022-05-14 14:43:30,972 env.py:  50: __LMOD_REF_COUNT_CMAKE_PREFIX_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0:1
INFO 2022-05-14 14:43:30,974 env.py:  50: __LMOD_REF_COUNT_CPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/include:1
INFO 2022-05-14 14:43:30,975 env.py:  50: __LMOD_REF_COUNT_CSPYTHONPREFIXES:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3:1
INFO 2022-05-14 14:43:30,977 env.py:  50: __LMOD_REF_COUNT_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib:1
INFO 2022-05-14 14:43:30,978 env.py:  50: __LMOD_REF_COUNT_LOADEDMODULES:	Mila:1;gcc/7.4.0:1;anaconda/3:1
INFO 2022-05-14 14:43:30,979 env.py:  50: __LMOD_REF_COUNT_MANPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/share/man:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/share/man:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man:1
INFO 2022-05-14 14:43:30,981 env.py:  50: __LMOD_REF_COUNT_MODULEPATH:	/cvmfs/config.mila.quebec/modules/Core:1;/cvmfs/config.mila.quebec/modules/Compiler:1;/cvmfs/config.mila.quebec/modules/Environments:1;/cvmfs/config.mila.quebec/modules/Cuda:1;/cvmfs/config.mila.quebec/modules/Pytorch:1;/cvmfs/config.mila.quebec/modules/Tensorflow:1
INFO 2022-05-14 14:43:30,982 env.py:  50: __LMOD_REF_COUNT_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin:1;/opt/slurm/bin:1;/sbin:1;/bin:1;/usr/sbin:1;/usr/bin:1
INFO 2022-05-14 14:43:30,983 env.py:  50: __LMOD_REF_COUNT_PKG_CONFIG_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/pkgconfig:1
INFO 2022-05-14 14:43:30,984 env.py:  50: __LMOD_REF_COUNT_PYTHONPATH:	/cvmfs/config.mila.quebec/etc/python.d/3.7:1
INFO 2022-05-14 14:43:30,985 env.py:  50: __LMOD_REF_COUNT__LMFILES_:	/cvmfs/config.mila.quebec/modules/Core/Mila.lua:1;/cvmfs/config.mila.quebec/modules/Core/gcc/7.4.0.lua:1;/cvmfs/config.mila.quebec/modules/Core/anaconda/3.lua:1
INFO 2022-05-14 14:43:30,987 misc.py: 161: Set start method of multiprocessing to forkserver
INFO 2022-05-14 14:43:30,988 train.py: 105: Setting seed....
INFO 2022-05-14 14:43:30,990 misc.py: 173: MACHINE SEED: 0
INFO 2022-05-14 14:43:31,077 hydra_config.py: 132: Training with config:
INFO 2022-05-14 14:43:31,086 hydra_config.py: 141: {'CHECKPOINT': {'APPEND_DISTR_RUN_ID': False,
                'AUTO_RESUME': True,
                'BACKEND': 'disk',
                'CHECKPOINT_FREQUENCY': 1,
                'CHECKPOINT_ITER_FREQUENCY': -1,
                'DIR': './checkpoints/eval_trained_swav/0',
                'LATEST_CHECKPOINT_RESUME_FILE_NUM': 1,
                'OVERWRITE_EXISTING': False,
                'USE_SYMLINK_CHECKPOINT_FOR_RESUME': False},
 'CLUSTERFIT': {'CLUSTER_BACKEND': 'faiss',
                'DATA_LIMIT': -1,
                'DATA_LIMIT_SAMPLING': {'SEED': 0},
                'FEATURES': {'DATASET_NAME': '',
                             'DATA_PARTITION': 'TRAIN',
                             'DIMENSIONALITY_REDUCTION': 0,
                             'EXTRACT': False,
                             'LAYER_NAME': '',
                             'PATH': '.',
                             'TEST_PARTITION': 'TEST'},
                'NUM_CLUSTERS': 16000,
                'NUM_ITER': 50,
                'OUTPUT_DIR': '.'},
 'DATA': {'DDP_BUCKET_CAP_MB': 25,
          'ENABLE_ASYNC_GPU_COPY': True,
          'NUM_DATALOADER_WORKERS': 4,
          'PIN_MEMORY': True,
          'TEST': {'BASE_DATASET': 'generic_ssl',
                   'BATCHSIZE_PER_REPLICA': 512,
                   'COLLATE_FUNCTION': 'multicrop_collator',
                   'COLLATE_FUNCTION_PARAMS': {},
                   'COPY_DESTINATION_DIR': '/tmp/imagenet1k/',
                   'COPY_TO_LOCAL_DISK': False,
                   'DATASET_NAMES': ['CIFAR100'],
                   'DATA_LIMIT': -1,
                   'DATA_LIMIT_SAMPLING': {'IS_BALANCED': False,
                                           'SEED': 0,
                                           'SKIP_NUM_SAMPLES': 0},
                   'DATA_PATHS': [],
                   'DATA_SOURCES': ['disk_folder'],
                   'DEFAULT_GRAY_IMG_SIZE': 224,
                   'DROP_LAST': True,
                   'ENABLE_QUEUE_DATASET': False,
                   'INPUT_KEY_NAMES': ['data'],
                   'LABEL_PATHS': [],
                   'LABEL_SOURCES': [],
                   'LABEL_TYPE': 'sample_index',
                   'MMAP_MODE': True,
                   'NEW_IMG_PATH_PREFIX': '',
                   'RANDOM_SYNTHETIC_IMAGES': False,
                   'REMOVE_IMG_PATH_PREFIX': '',
                   'TARGET_KEY_NAMES': ['label'],
                   'TRANSFORMS': [{'crop_scales': [[0.08, 1]],
                                   'name': 'ImgPilToMultiCrop',
                                   'num_crops': [2],
                                   'size_crops': [32],
                                   'total_num_crops': 2},
                                  {'name': 'RandomHorizontalFlip', 'p': 0.5},
                                  {'name': 'ImgPilColorDistortion',
                                   'strength': 1.0},
                                  {'name': 'ImgPilGaussianBlur',
                                   'p': 0.5,
                                   'radius_max': 2.0,
                                   'radius_min': 0.1},
                                  {'name': 'ToTensor'},
                                  {'mean': [0.5074, 0.4867, 0.4411],
                                   'name': 'Normalize',
                                   'std': [0.2011, 0.1987, 0.202]}],
                   'USE_DEBUGGING_SAMPLER': False,
                   'USE_STATEFUL_DISTRIBUTED_SAMPLER': False},
          'TRAIN': {'BASE_DATASET': 'generic_ssl',
                    'BATCHSIZE_PER_REPLICA': 512,
                    'COLLATE_FUNCTION': 'multicrop_collator',
                    'COLLATE_FUNCTION_PARAMS': {},
                    'COPY_DESTINATION_DIR': '/tmp/imagenet1k/',
                    'COPY_TO_LOCAL_DISK': False,
                    'DATASET_NAMES': ['CIFAR100'],
                    'DATA_LIMIT': -1,
                    'DATA_LIMIT_SAMPLING': {'IS_BALANCED': False,
                                            'SEED': 0,
                                            'SKIP_NUM_SAMPLES': 0},
                    'DATA_PATHS': [],
                    'DATA_SOURCES': ['disk_folder'],
                    'DEFAULT_GRAY_IMG_SIZE': 224,
                    'DROP_LAST': True,
                    'ENABLE_QUEUE_DATASET': False,
                    'INPUT_KEY_NAMES': ['data'],
                    'LABEL_PATHS': [],
                    'LABEL_SOURCES': [],
                    'LABEL_TYPE': 'sample_index',
                    'MMAP_MODE': True,
                    'NEW_IMG_PATH_PREFIX': '',
                    'RANDOM_SYNTHETIC_IMAGES': False,
                    'REMOVE_IMG_PATH_PREFIX': '',
                    'TARGET_KEY_NAMES': ['label'],
                    'TRANSFORMS': [{'crop_scales': [[0.08, 1]],
                                    'name': 'ImgPilToMultiCrop',
                                    'num_crops': [2],
                                    'size_crops': [32],
                                    'total_num_crops': 2},
                                   {'name': 'RandomHorizontalFlip', 'p': 0.5},
                                   {'name': 'ImgPilColorDistortion',
                                    'strength': 1.0},
                                   {'name': 'ImgPilGaussianBlur',
                                    'p': 0.5,
                                    'radius_max': 2.0,
                                    'radius_min': 0.1},
                                   {'name': 'ToTensor'},
                                   {'mean': [0.5074, 0.4867, 0.4411],
                                    'name': 'Normalize',
                                    'std': [0.2011, 0.1987, 0.202]}],
                    'USE_DEBUGGING_SAMPLER': False,
                    'USE_STATEFUL_DISTRIBUTED_SAMPLER': False}},
 'DISTRIBUTED': {'BACKEND': 'nccl',
                 'BROADCAST_BUFFERS': True,
                 'INIT_METHOD': 'tcp',
                 'MANUAL_GRADIENT_REDUCTION': False,
                 'NCCL_DEBUG': False,
                 'NCCL_SOCKET_NTHREADS': '',
                 'NUM_NODES': 1,
                 'NUM_PROC_PER_NODE': 1,
                 'RUN_ID': 'auto'},
 'EXTRACT_FEATURES': {'CHUNK_THRESHOLD': 0, 'OUTPUT_DIR': ''},
 'HOOKS': {'CHECK_NAN': True,
           'LOG_GPU_STATS': True,
           'MEMORY_SUMMARY': {'DUMP_MEMORY_ON_EXCEPTION': False,
                              'LOG_ITERATION_NUM': 0,
                              'PRINT_MEMORY_SUMMARY': True},
           'MODEL_COMPLEXITY': {'COMPUTE_COMPLEXITY': False,
                                'INPUT_SHAPE': [3, 224, 224]},
           'PERF_STATS': {'MONITOR_PERF_STATS': True,
                          'PERF_STAT_FREQUENCY': -1,
                          'ROLLING_BTIME_FREQ': -1},
           'TENSORBOARD_SETUP': {'EXPERIMENT_LOG_DIR': 'tensorboard',
                                 'FLUSH_EVERY_N_MIN': 5,
                                 'LOG_DIR': '.',
                                 'LOG_PARAMS': True,
                                 'LOG_PARAMS_EVERY_N_ITERS': 310,
                                 'LOG_PARAMS_GRADIENTS': True,
                                 'USE_TENSORBOARD': False}},
 'IMG_RETRIEVAL': {'CROP_QUERY_ROI': False,
                   'DATASET_PATH': '',
                   'DEBUG_MODE': False,
                   'EVAL_BINARY_PATH': '',
                   'EVAL_DATASET_NAME': 'Paris',
                   'FEATS_PROCESSING_TYPE': '',
                   'GEM_POOL_POWER': 4.0,
                   'IMG_SCALINGS': [1],
                   'NORMALIZE_FEATURES': True,
                   'NUM_DATABASE_SAMPLES': -1,
                   'NUM_QUERY_SAMPLES': -1,
                   'NUM_TRAINING_SAMPLES': -1,
                   'N_PCA': 512,
                   'RESIZE_IMG': 1024,
                   'SAVE_FEATURES': False,
                   'SAVE_RETRIEVAL_RANKINGS_SCORES': True,
                   'SIMILARITY_MEASURE': 'cosine_similarity',
                   'SPATIAL_LEVELS': 3,
                   'TRAIN_DATASET_NAME': 'Oxford',
                   'TRAIN_PCA_WHITENING': True,
                   'USE_DISTRACTORS': False,
                   'WHITEN_IMG_LIST': ''},
 'LOG_FREQUENCY': 1,
 'LOSS': {'CrossEntropyLoss': {'ignore_index': -1},
          'barlow_twins_loss': {'embedding_dim': 8192,
                                'lambda_': 0.0051,
                                'scale_loss': 0.024},
          'bce_logits_multiple_output_single_target': {'normalize_output': False,
                                                       'reduction': 'none',
                                                       'world_size': 1},
          'cross_entropy_multiple_output_single_target': {'ignore_index': -1,
                                                          'normalize_output': False,
                                                          'reduction': 'mean',
                                                          'temperature': 1.0,
                                                          'weight': None},
          'deepclusterv2_loss': {'BATCHSIZE_PER_REPLICA': 256,
                                 'DROP_LAST': True,
                                 'kmeans_iters': 10,
                                 'memory_params': {'crops_for_mb': [0],
                                                   'embedding_dim': 128},
                                 'num_clusters': [3000, 3000, 3000],
                                 'num_crops': 2,
                                 'num_train_samples': -1,
                                 'temperature': 0.1},
          'dino_loss': {'crops_for_teacher': [0, 1],
                        'ema_center': 0.9,
                        'momentum': 0.996,
                        'normalize_last_layer': True,
                        'output_dim': 65536,
                        'student_temp': 0.1,
                        'teacher_temp_max': 0.07,
                        'teacher_temp_min': 0.04,
                        'teacher_temp_warmup_iters': 37500},
          'moco_loss': {'embedding_dim': 128,
                        'momentum': 0.999,
                        'queue_size': 65536,
                        'temperature': 0.2},
          'multicrop_simclr_info_nce_loss': {'buffer_params': {'effective_batch_size': 4096,
                                                               'embedding_dim': 128,
                                                               'world_size': 64},
                                             'num_crops': 2,
                                             'temperature': 0.1},
          'name': 'swav_loss',
          'nce_loss_with_memory': {'loss_type': 'nce',
                                   'loss_weights': [1.0],
                                   'memory_params': {'embedding_dim': 128,
                                                     'memory_size': -1,
                                                     'momentum': 0.5,
                                                     'norm_init': True,
                                                     'update_mem_on_forward': True},
                                   'negative_sampling_params': {'num_negatives': 16000,
                                                                'type': 'random'},
                                   'norm_constant': -1,
                                   'norm_embedding': True,
                                   'num_train_samples': -1,
                                   'temperature': 0.07,
                                   'update_mem_with_emb_index': -100},
          'simclr_info_nce_loss': {'buffer_params': {'effective_batch_size': 4096,
                                                     'embedding_dim': 128,
                                                     'world_size': 64},
                                   'temperature': 0.1},
          'swav_loss': {'crops_for_assign': [0, 1],
                        'embedding_dim': 128,
                        'epsilon': 0.05,
                        'normalize_last_layer': True,
                        'num_crops': 2,
                        'num_iters': 3,
                        'num_prototypes': [30],
                        'output_dir': './checkpoints/eval_trained_swav/0',
                        'queue': {'local_queue_length': 0,
                                  'queue_length': 0,
                                  'start_iter': 0},
                        'temp_hard_assignment_iters': 0,
                        'temperature': 0.5,
                        'use_double_precision': False},
          'swav_momentum_loss': {'crops_for_assign': [0, 1],
                                 'embedding_dim': 128,
                                 'epsilon': 0.05,
                                 'momentum': 0.99,
                                 'momentum_eval_mode_iter_start': 0,
                                 'normalize_last_layer': True,
                                 'num_crops': 2,
                                 'num_iters': 3,
                                 'num_prototypes': [3000],
                                 'queue': {'local_queue_length': 0,
                                           'queue_length': 0,
                                           'start_iter': 0},
                                 'temperature': 0.1,
                                 'use_double_precision': False}},
 'MACHINE': {'DEVICE': 'gpu'},
 'METERS': {'accuracy_list_meter': {'meter_names': [],
                                    'num_meters': 1,
                                    'topk_values': [1]},
            'enable_training_meter': True,
            'mean_ap_list_meter': {'max_cpu_capacity': -1,
                                   'meter_names': [],
                                   'num_classes': 9605,
                                   'num_meters': 1},
            'model_output_mask': False,
            'name': '',
            'names': [],
            'precision_at_k_list_meter': {'meter_names': [],
                                          'num_meters': 1,
                                          'topk_values': [1]},
            'recall_at_k_list_meter': {'meter_names': [],
                                       'num_meters': 1,
                                       'topk_values': [1]}},
 'MODEL': {'ACTIVATION_CHECKPOINTING': {'NUM_ACTIVATION_CHECKPOINTING_SPLITS': 2,
                                        'USE_ACTIVATION_CHECKPOINTING': False},
           'AMP_PARAMS': {'AMP_ARGS': {'opt_level': 'O1'},
                          'AMP_TYPE': 'apex',
                          'USE_AMP': False},
           'BASE_MODEL_NAME': 'multi_input_output_model',
           'CUDA_CACHE': {'CLEAR_CUDA_CACHE': False, 'CLEAR_FREQ': 100},
           'FEATURE_EVAL_SETTINGS': {'EVAL_MODE_ON': False,
                                     'EVAL_TRUNK_AND_HEAD': False,
                                     'EXTRACT_TRUNK_FEATURES_ONLY': False,
                                     'FREEZE_TRUNK_AND_HEAD': False,
                                     'FREEZE_TRUNK_ONLY': False,
                                     'LINEAR_EVAL_FEAT_POOL_OPS_MAP': [],
                                     'SHOULD_FLATTEN_FEATS': True},
           'FSDP_CONFIG': {'AUTO_WRAP_THRESHOLD': 0,
                           'bucket_cap_mb': 0,
                           'clear_autocast_cache': True,
                           'compute_dtype': torch.float32,
                           'flatten_parameters': True,
                           'fp32_reduce_scatter': False,
                           'mixed_precision': True,
                           'verbose': True},
           'GRAD_CLIP': {'MAX_NORM': 1, 'NORM_TYPE': 2, 'USE_GRAD_CLIP': False},
           'HEAD': {'BATCHNORM_EPS': 1e-05,
                    'BATCHNORM_MOMENTUM': 0.1,
                    'PARAMS': [['swav_head',
                                {'dims': [512, 512, 128],
                                 'num_clusters': [30],
                                 'use_bn': True}]],
                    'PARAMS_MULTIPLIER': 1.0},
           'INPUT_TYPE': 'rgb',
           'MULTI_INPUT_HEAD_MAPPING': [],
           'NON_TRAINABLE_PARAMS': [],
           'SHARDED_DDP_SETUP': {'USE_SDP': False, 'reduce_buffer_size': -1},
           'SINGLE_PASS_EVERY_CROP': False,
           'SYNC_BN_CONFIG': {'CONVERT_BN_TO_SYNC_BN': False,
                              'GROUP_SIZE': -1,
                              'SYNC_BN_TYPE': 'pytorch'},
           'TEMP_FROZEN_PARAMS_ITER_MAP': [['module.heads.0.prototypes0.weight',
                                            900]],
           'TRUNK': {'CONVIT': {'CLASS_TOKEN_IN_LOCAL_LAYERS': False,
                                'LOCALITY_DIM': 10,
                                'LOCALITY_STRENGTH': 1.0,
                                'N_GPSA_LAYERS': 10,
                                'USE_LOCAL_INIT': True},
                     'EFFICIENT_NETS': {},
                     'NAME': 'resnet',
                     'REGNET': {},
                     'RESNETS': {'BLOCK': 'BasicBlock',
                                 'CONV1_KERNEL': 3,
                                 'CONV1_PADDING': 1,
                                 'CONV1_STRIDE': 1,
                                 'DEPTH': 18,
                                 'GROUPNORM_GROUPS': 32,
                                 'GROUPS': 1,
                                 'LAYER4_STRIDE': 2,
                                 'MAXPOOL': False,
                                 'NORM': 'BatchNorm',
                                 'STANDARDIZE_CONVOLUTIONS': False,
                                 'WIDTH_MULTIPLIER': 1,
                                 'WIDTH_PER_GROUP': 64,
                                 'ZERO_INIT_RESIDUAL': False},
                     'VISION_TRANSFORMERS': {'ATTENTION_DROPOUT_RATE': 0,
                                             'CLASSIFIER': 'token',
                                             'DROPOUT_RATE': 0,
                                             'DROP_PATH_RATE': 0,
                                             'HIDDEN_DIM': 768,
                                             'IMAGE_SIZE': 224,
                                             'MLP_DIM': 3072,
                                             'NUM_HEADS': 12,
                                             'NUM_LAYERS': 12,
                                             'PATCH_SIZE': 16,
                                             'QKV_BIAS': False,
                                             'QK_SCALE': False,
                                             'name': None},
                     'XCIT': {'ATTENTION_DROPOUT_RATE': 0,
                              'DROPOUT_RATE': 0,
                              'DROP_PATH_RATE': 0.05,
                              'ETA': 1,
                              'HIDDEN_DIM': 384,
                              'IMAGE_SIZE': 224,
                              'NUM_HEADS': 8,
                              'NUM_LAYERS': 12,
                              'PATCH_SIZE': 16,
                              'QKV_BIAS': True,
                              'QK_SCALE': False,
                              'TOKENS_NORM': True,
                              'name': None}},
           'WEIGHTS_INIT': {'APPEND_PREFIX': '',
                            'PARAMS_FILE': '',
                            'REMOVE_PREFIX': '',
                            'SKIP_LAYERS': ['num_batches_tracked'],
                            'STATE_DICT_KEY_NAME': 'classy_state_dict'},
           '_MODEL_INIT_SEED': 0},
 'MONITORING': {'MONITOR_ACTIVATION_STATISTICS': 0},
 'MULTI_PROCESSING_METHOD': 'forkserver',
 'NEAREST_NEIGHBOR': {'L2_NORM_FEATS': False, 'SIGMA': 0.1, 'TOPK': 200},
 'OPTIMIZER': {'betas': [0.9, 0.999],
               'construct_single_param_group_only': False,
               'head_optimizer_params': {'use_different_lr': False,
                                         'use_different_wd': False,
                                         'weight_decay': 1e-06},
               'larc_config': {'clip': False,
                               'eps': 1e-08,
                               'trust_coefficient': 0.001},
               'momentum': 0.9,
               'name': 'sgd',
               'nesterov': False,
               'non_regularized_parameters': [],
               'num_epochs': 1,
               'param_schedulers': {'lr': {'auto_lr_scaling': {'auto_scale': False,
                                                               'base_lr_batch_size': 256,
                                                               'base_value': 0.1,
                                                               'scaling_type': 'linear'},
                                           'end_value': 0.0006,
                                           'interval_scaling': [],
                                           'lengths': [],
                                           'milestones': [30, 60],
                                           'name': 'cosine',
                                           'schedulers': [],
                                           'start_value': 0.06,
                                           'update_interval': 'epoch',
                                           'value': 0.1,
                                           'values': [0.1, 0.01, 0.001]},
                                    'lr_head': {'auto_lr_scaling': {'auto_scale': False,
                                                                    'base_lr_batch_size': 256,
                                                                    'base_value': 0.1,
                                                                    'scaling_type': 'linear'},
                                                'end_value': 0.0006,
                                                'interval_scaling': [],
                                                'lengths': [],
                                                'milestones': [30, 60],
                                                'name': 'cosine',
                                                'schedulers': [],
                                                'start_value': 0.06,
                                                'update_interval': 'epoch',
                                                'value': 0.1,
                                                'values': [0.1, 0.01, 0.001]}},
               'regularize_bias': True,
               'regularize_bn': False,
               'use_larc': True,
               'use_zero': False,
               'weight_decay': 1e-06},
 'PROFILING': {'MEMORY_PROFILING': {'TRACK_BY_LAYER_MEMORY': False},
               'NUM_ITERATIONS': 10,
               'OUTPUT_FOLDER': '.',
               'PROFILED_RANKS': [0, 1],
               'RUNTIME_PROFILING': {'LEGACY_PROFILER': False,
                                     'PROFILE_CPU': True,
                                     'PROFILE_GPU': True,
                                     'USE_PROFILER': False},
               'START_ITERATION': 0,
               'STOP_TRAINING_AFTER_PROFILING': False,
               'WARMUP_ITERATIONS': 0},
 'REPRODUCIBILITY': {'CUDDN_DETERMINISTIC': False},
 'SEED_VALUE': 0,
 'SLURM': {'ADDITIONAL_PARAMETERS': {},
           'COMMENT': 'vissl job',
           'CONSTRAINT': '',
           'LOG_FOLDER': '.',
           'MEM_GB': 250,
           'NAME': 'vissl',
           'NUM_CPU_PER_PROC': 8,
           'PARTITION': '',
           'PORT_ID': 40050,
           'TIME_HOURS': 72,
           'TIME_MINUTES': 0,
           'USE_SLURM': False},
 'SVM': {'cls_list': [],
         'costs': {'base': -1.0,
                   'costs_list': [0.1, 0.01],
                   'power_range': [4, 20]},
         'cross_val_folds': 3,
         'dual': True,
         'force_retrain': False,
         'loss': 'squared_hinge',
         'low_shot': {'dataset_name': 'voc',
                      'k_values': [1, 2, 4, 8, 16, 32, 64, 96],
                      'sample_inds': [1, 2, 3, 4, 5]},
         'max_iter': 2000,
         'normalize': True,
         'penalty': 'l2'},
 'TEST_EVERY_NUM_EPOCH': 1,
 'TEST_MODEL': True,
 'TEST_ONLY': True,
 'TRAINER': {'TASK_NAME': 'self_supervision_task',
             'TRAIN_STEP_NAME': 'standard_train_step'},
 'VERBOSE': False,
 'WEIGHTS_INIT': {'PARAMS_FILE': './checkpoints/trained_swav/0/model_phase100.torch'}}
INFO 2022-05-14 14:43:46,637 train.py: 117: System config:
-------------------  ---------------------------------------------------------------------------------------------------------------
sys.platform         linux
Python               3.8.13 (default, Mar 28 2022, 11:38:47) [GCC 7.5.0]
numpy                1.19.5
Pillow               9.0.1
vissl                0.1.6 @/home/mila/r/rajkuman/mina/mphil-vissl/vissl
GPU available        True
GPU 0                Tesla V100-SXM2-32GB-LS
CUDA_HOME            None
torchvision          0.9.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/torchvision
hydra                1.0.7 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/hydra_core-1.0.7-py3.8.egg/hydra
classy_vision        0.7.0.dev @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/classy_vision
tensorboard          2.9.0
apex                 0.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/apex
PyTorch              1.8.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/torch
PyTorch debug build  False
-------------------  ---------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.7.0 (Git Hash 7aed236906b1f7a05c0917e5257a1af05e9ff683)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.8.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

CPU info:
-------------------  -----------------------------------------
Architecture         x86_64
CPU op-mode(s)       32-bit, 64-bit
Byte Order           Little Endian
CPU(s)               80
On-line CPU(s) list  0-79
Thread(s) per core   2
Core(s) per socket   20
Socket(s)            2
NUMA node(s)         2
Vendor ID            GenuineIntel
CPU family           6
Model                79
Model name           Intel(R) Xeon(R) CPU E5-2698 v4 @ 2.20GHz
Stepping             1
CPU MHz              2697.601
CPU max MHz          3600.0000
CPU min MHz          1200.0000
BogoMIPS             4389.95
Virtualization       VT-x
L1d cache            32K
L1i cache            32K
L2 cache             256K
L3 cache             51200K
NUMA node0 CPU(s)    0-19,40-59
NUMA node1 CPU(s)    20-39,60-79
-------------------  -----------------------------------------
INFO 2022-05-14 14:43:46,649 trainer_main.py: 112: Using Distributed init method: tcp://localhost:39311, world_size: 1, rank: 0
INFO 2022-05-14 14:43:46,660 distributed_c10d.py: 187: Added key: store_based_barrier_key:1 to store for rank: 0
INFO 2022-05-14 14:43:46,662 trainer_main.py: 130: | initialized host mila03.server.mila.quebec as rank 0 (0)
INFO 2022-05-14 14:44:00,749 train_task.py: 181: Not using Automatic Mixed Precision
INFO 2022-05-14 14:44:00,751 train_task.py: 455: Building model....
INFO 2022-05-14 14:44:00,752 resnext.py:  66: ResNeXT trunk, supports activation checkpointing. Deactivated
INFO 2022-05-14 14:44:00,753 resnext.py:  93: Building model: ResNeXt18-1x64d-w1-BatchNorm2d
INFO 2022-05-14 14:44:01,128 train_task.py: 656: Broadcast model BN buffers from primary on every forward pass
INFO 2022-05-14 14:44:01,129 classification_task.py: 387: Synchronized Batch Normalization is disabled
INFO 2022-05-14 14:44:01,150 optimizer_helper.py: 293: 
Trainable params: 67, 
Non-Trainable params: 0, 
Trunk Regularized Parameters: 20, 
Trunk Unregularized Parameters 40, 
Head Regularized Parameters: 5, 
Head Unregularized Parameters: 2 
Remaining Regularized Parameters: 0 
Remaining Unregularized Parameters: 0
INFO 2022-05-14 14:44:01,156 img_pil_color_distortion.py:  56: ImgPilColorDistortion | Using strength: 1.0
INFO 2022-05-14 14:44:01,165 ssl_dataset.py: 156: Rank: 0 split: TEST Data files:
['data/CIFAR-100-dataset/test']
INFO 2022-05-14 14:44:01,166 ssl_dataset.py: 159: Rank: 0 split: TEST Label files:
[]
INFO 2022-05-14 14:44:01,628 disk_dataset.py:  86: Loaded 10000 samples from folder data/CIFAR-100-dataset/test
INFO 2022-05-14 14:44:01,629 misc.py: 161: Set start method of multiprocessing to forkserver
INFO 2022-05-14 14:44:01,630 __init__.py: 126: Created the Distributed Sampler....
INFO 2022-05-14 14:44:01,631 __init__.py: 101: Distributed Sampler config:
{'num_replicas': 1, 'rank': 0, 'epoch': 0, 'num_samples': 10000, 'total_size': 10000, 'shuffle': True, 'seed': 0}
INFO 2022-05-14 14:44:01,633 __init__.py: 215: Wrapping the dataloader to async device copies
INFO 2022-05-14 14:44:01,634 train_task.py: 384: Building loss...
INFO 2022-05-14 14:44:01,636 trainer_main.py: 268: Training 1 epochs
INFO 2022-05-14 14:44:01,637 trainer_main.py: 269: One epoch = 19 iterations.
INFO 2022-05-14 14:44:01,638 trainer_main.py: 270: Total 10000 samples in one epoch
INFO 2022-05-14 14:44:01,639 trainer_main.py: 276: Total 19 iterations for training
INFO 2022-05-14 14:44:01,818 logger.py:  84: Sat May 14 14:44:01 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.82.01    Driver Version: 470.82.01    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  Off  | 00000000:8A:00.0 Off |                    0 |
| N/A   30C    P0    47W / 163W |   1202MiB / 32510MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A     79117      C   python                           1199MiB |
+-----------------------------------------------------------------------------+

INFO 2022-05-14 14:44:01,820 trainer_main.py: 173: Model is:
 Classy <class 'vissl.models.base_ssl_model.BaseSSLMultiInputOutputModel'>:
BaseSSLMultiInputOutputModel(
  (_heads): ModuleDict()
  (trunk): ResNeXt(
    (_feature_blocks): ModuleDict(
      (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv1_relu): ReLU(inplace=True)
      (maxpool): Identity()
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(<SUPPORTED_L4_STRIDE.two: 2>, <SUPPORTED_L4_STRIDE.two: 2>), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(<SUPPORTED_L4_STRIDE.two: 2>, <SUPPORTED_L4_STRIDE.two: 2>), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (flatten): Flatten()
    )
  )
  (heads): ModuleList(
    (0): SwAVPrototypesHead(
      (projection_head): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Linear(in_features=512, out_features=128, bias=True)
      )
      (prototypes0): Linear(in_features=128, out_features=30, bias=False)
    )
  )
)
INFO 2022-05-14 14:44:01,821 trainer_main.py: 174: Loss is: { 'embedding_dim': 128,
  'epsilon': 0.05,
  'local_queue_length': 0,
  'name': 'SwAVLoss',
  'nmb_sinkhornknopp_iters': 3,
  'num_crops': 2,
  'num_prototypes': [30],
  'temp_hard_assignment_iters': 0,
  'temperature': 0.5,
  'use_double_precision': False}
INFO 2022-05-14 14:44:01,822 trainer_main.py: 175: Starting training....
INFO 2022-05-14 14:44:01,823 __init__.py: 101: Distributed Sampler config:
{'num_replicas': 1, 'rank': 0, 'epoch': 0, 'num_samples': 10000, 'total_size': 10000, 'shuffle': True, 'seed': 0}
INFO 2022-05-14 14:46:44,940 trainer_main.py: 333: Phase advanced. Rank: 0
INFO 2022-05-14 14:46:44,944 log_hooks.py:  76: ========= Memory Summary at on_phase_start =======
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   57299 KB |   57299 KB |   57300 KB |     512 B  |
|       from large pool |   52608 KB |   52608 KB |   52608 KB |       0 B  |
|       from small pool |    4691 KB |    4691 KB |    4692 KB |     512 B  |
|---------------------------------------------------------------------------|
| Active memory         |   57299 KB |   57299 KB |   57300 KB |     512 B  |
|       from large pool |   52608 KB |   52608 KB |   52608 KB |       0 B  |
|       from small pool |    4691 KB |    4691 KB |    4692 KB |     512 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   90112 KB |   90112 KB |   90112 KB |       0 B  |
|       from large pool |   81920 KB |   81920 KB |   81920 KB |       0 B  |
|       from small pool |    8192 KB |    8192 KB |    8192 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   32812 KB |   36932 KB |   64816 KB |   32004 KB |
|       from large pool |   29312 KB |   35456 KB |   56192 KB |   26880 KB |
|       from small pool |    3500 KB |    3516 KB |    8624 KB |    5124 KB |
|---------------------------------------------------------------------------|
| Allocations           |     136    |     136    |     137    |       1    |
|       from large pool |      10    |      10    |      10    |       0    |
|       from small pool |     126    |     126    |     127    |       1    |
|---------------------------------------------------------------------------|
| Active allocs         |     136    |     136    |     137    |       1    |
|       from large pool |      10    |      10    |      10    |       0    |
|       from small pool |     126    |     126    |     127    |       1    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       8    |       8    |       8    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |       8    |       9    |       1    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       4    |       4    |       5    |       1    |
|===========================================================================|


INFO 2022-05-14 14:46:44,945 state_update_hooks.py: 115: Starting phase 0 [test]
INFO 2022-05-14 14:46:47,723 log_hooks.py:  76: ========= Memory Summary at on_forward =======
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70243 KB |    5648 MB |   28939 MB |   28870 MB |
|       from large pool |   64896 KB |    5643 MB |   28931 MB |   28868 MB |
|       from small pool |    5347 KB |       5 MB |       7 MB |       2 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70243 KB |    5648 MB |   28939 MB |   28870 MB |
|       from large pool |   64896 KB |    5643 MB |   28931 MB |   28868 MB |
|       from small pool |    5347 KB |       5 MB |       7 MB |       2 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  569344 KB |    9628 MB |   16676 MB |   16120 MB |
|       from large pool |  561152 KB |    9620 MB |   16668 MB |   16120 MB |
|       from small pool |    8192 KB |       8 MB |       8 MB |       0 MB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   40348 KB |    5430 MB |   17135 MB |   17096 MB |
|       from large pool |   37504 KB |    5426 MB |   17125 MB |   17088 MB |
|       from small pool |    2844 KB |       3 MB |      10 MB |       7 MB |
|---------------------------------------------------------------------------|
| Allocations           |     143    |     147    |     221    |      78    |
|       from large pool |      12    |      18    |      77    |      65    |
|       from small pool |     131    |     132    |     144    |      13    |
|---------------------------------------------------------------------------|
| Active allocs         |     143    |     147    |     221    |      78    |
|       from large pool |      12    |      18    |      77    |      65    |
|       from small pool |     131    |     132    |     144    |      13    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      12    |      13    |      17    |       5    |
|       from large pool |       8    |       9    |      13    |       5    |
|       from small pool |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      13    |      41    |      32    |
|       from large pool |       5    |       9    |      34    |      29    |
|       from small pool |       4    |       5    |       7    |       3    |
|===========================================================================|


INFO 2022-05-14 14:47:12,997 trainer_main.py: 214: Meters synced
INFO 2022-05-14 14:47:13,003 log_hooks.py: 568: Average test batch time (ms) for 19 batches: 1476
INFO 2022-05-14 14:47:13,005 io.py:  63: Saving data to file: ./checkpoints/eval_trained_swav/0/metrics.json
INFO 2022-05-14 14:47:13,018 io.py:  89: Saved data to file: ./checkpoints/eval_trained_swav/0/metrics.json
INFO 2022-05-14 14:47:13,136 train.py: 131: All Done!
INFO 2022-05-14 14:47:13,137 logger.py:  73: Shutting down loggers...
INFO 2022-05-14 14:47:13,139 distributed_launcher.py: 168: All Done!
INFO 2022-05-14 14:47:13,140 logger.py:  73: Shutting down loggers...
INFO 2022-05-14 15:39:18,229 train.py:  94: Env set for rank: 0, dist_rank: 0
INFO 2022-05-14 15:39:18,231 env.py:  50: ARCH:	x86_64
INFO 2022-05-14 15:39:18,233 env.py:  50: BASH_ENV:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/init/bash
INFO 2022-05-14 15:39:18,234 env.py:  50: BASH_FUNC_ml%%:	() {  eval $($LMOD_DIR/ml_cmd "$@")
}
INFO 2022-05-14 15:39:18,236 env.py:  50: BASH_FUNC_module%%:	() {  eval $($LMOD_CMD bash "$@") && eval $(${LMOD_SETTARG_CMD:-:} -s sh)
}
INFO 2022-05-14 15:39:18,237 env.py:  50: CMAKE_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64
INFO 2022-05-14 15:39:18,239 env.py:  50: CMAKE_PREFIX_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0
INFO 2022-05-14 15:39:18,239 env.py:  50: COLUMNS:	202
INFO 2022-05-14 15:39:18,241 env.py:  50: CONDA_ACTIVATE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/etc/profile.d/conda.sh
INFO 2022-05-14 15:39:18,242 env.py:  50: CONDA_DEFAULT_ENV:	vissl_env
INFO 2022-05-14 15:39:18,244 env.py:  50: CONDA_EXE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin/conda
INFO 2022-05-14 15:39:18,245 env.py:  50: CONDA_PREFIX:	/home/mila/r/rajkuman/.conda/envs/vissl_env
INFO 2022-05-14 15:39:18,247 env.py:  50: CONDA_PROMPT_MODIFIER:	(vissl_env) 
INFO 2022-05-14 15:39:18,248 env.py:  50: CONDA_PYTHON_EXE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin/python
INFO 2022-05-14 15:39:18,250 env.py:  50: CONDA_SHLVL:	1
INFO 2022-05-14 15:39:18,251 env.py:  50: CPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/include
INFO 2022-05-14 15:39:18,253 env.py:  50: CSPYTHONPREFIXES:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3
INFO 2022-05-14 15:39:18,255 env.py:  50: CUDA_VISIBLE_DEVICES:	0
INFO 2022-05-14 15:39:18,256 env.py:  50: ENVIRONMENT:	BATCH
INFO 2022-05-14 15:39:18,258 env.py:  50: GPU_DEVICE_ORDINAL:	0
INFO 2022-05-14 15:39:18,259 env.py:  50: HOME:	/home/mila/r/rajkuman
INFO 2022-05-14 15:39:18,261 env.py:  50: HOSTNAME:	mila03
INFO 2022-05-14 15:39:18,262 env.py:  50: ID:	debian
INFO 2022-05-14 15:39:18,264 env.py:  50: JPY_API_TOKEN:	834ce4aa2de248308d2103afece2e12b
INFO 2022-05-14 15:39:18,265 env.py:  50: JUPYTERHUB_ACTIVITY_URL:	http://172.16.2.123:8081/hub/api/users/rajkuman/activity
INFO 2022-05-14 15:39:18,266 env.py:  50: JUPYTERHUB_API_TOKEN:	834ce4aa2de248308d2103afece2e12b
INFO 2022-05-14 15:39:18,268 env.py:  50: JUPYTERHUB_API_URL:	http://172.16.2.123:8081/hub/api
INFO 2022-05-14 15:39:18,269 env.py:  50: JUPYTERHUB_BASE_URL:	/
INFO 2022-05-14 15:39:18,271 env.py:  50: JUPYTERHUB_CLIENT_ID:	jupyterhub-user-rajkuman
INFO 2022-05-14 15:39:18,272 env.py:  50: JUPYTERHUB_HOST:	
INFO 2022-05-14 15:39:18,274 env.py:  50: JUPYTERHUB_OAUTH_CALLBACK_URL:	/user/rajkuman/oauth_callback
INFO 2022-05-14 15:39:18,276 env.py:  50: JUPYTERHUB_SERVER_NAME:	
INFO 2022-05-14 15:39:18,277 env.py:  50: JUPYTERHUB_SERVICE_PREFIX:	/user/rajkuman/
INFO 2022-05-14 15:39:18,277 env.py:  50: JUPYTERHUB_USER:	rajkuman
INFO 2022-05-14 15:39:18,279 env.py:  50: JUPYTER_SERVER_ROOT:	/home/mila/r/rajkuman
INFO 2022-05-14 15:39:18,280 env.py:  50: JUPYTER_SERVER_URL:	http://0.0.0.0:57133/user/rajkuman/
INFO 2022-05-14 15:39:18,282 env.py:  50: KERNEL_LAUNCH_TIMEOUT:	40
INFO 2022-05-14 15:39:18,283 env.py:  50: LANG:	en_US.UTF-8
INFO 2022-05-14 15:39:18,284 env.py:  50: LANGUAGE:	en_CA:en
INFO 2022-05-14 15:39:18,286 env.py:  50: LESSCLOSE:	/bin/lesspipe %s %s
INFO 2022-05-14 15:39:18,287 env.py:  50: LESSOPEN:	| /bin/lesspipe %s
INFO 2022-05-14 15:39:18,288 env.py:  50: LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib
INFO 2022-05-14 15:39:18,290 env.py:  50: LINES:	50
INFO 2022-05-14 15:39:18,291 env.py:  50: LMOD_CMD:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec/lmod
INFO 2022-05-14 15:39:18,293 env.py:  50: LMOD_DIR:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec
INFO 2022-05-14 15:39:18,294 env.py:  50: LMOD_PACKAGE_PATH:	/cvmfs/config.mila.quebec/etc/lmod/
INFO 2022-05-14 15:39:18,295 env.py:  50: LMOD_PKG:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod
INFO 2022-05-14 15:39:18,297 env.py:  50: LMOD_ROOT:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod
INFO 2022-05-14 15:39:18,298 env.py:  50: LMOD_SETTARG_FULL_SUPPORT:	no
INFO 2022-05-14 15:39:18,300 env.py:  50: LMOD_SYSTEM_DEFAULT_MODULES:	Mila:gcc/7.4.0
INFO 2022-05-14 15:39:18,300 env.py:  50: LMOD_VERSION:	8.3.17
INFO 2022-05-14 15:39:18,301 env.py:  50: LMOD_sys:	Linux
INFO 2022-05-14 15:39:18,302 env.py:  50: LOADEDMODULES:	Mila:gcc/7.4.0:anaconda/3
INFO 2022-05-14 15:39:18,303 env.py:  50: LOCAL_RANK:	0
INFO 2022-05-14 15:39:18,304 env.py:  50: LOGNAME:	rajkuman
INFO 2022-05-14 15:39:18,305 env.py:  50: LS_COLORS:	rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
INFO 2022-05-14 15:39:18,306 env.py:  50: MAIL:	/var/mail/rajkuman
INFO 2022-05-14 15:39:18,308 env.py:  50: MANPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/share/man:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/share/man:/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man::
INFO 2022-05-14 15:39:18,309 env.py:  50: MODULEPATH:	/cvmfs/config.mila.quebec/modules/Core:/cvmfs/config.mila.quebec/modules/Compiler:/cvmfs/config.mila.quebec/modules/Environments:/cvmfs/config.mila.quebec/modules/Cuda:/cvmfs/config.mila.quebec/modules/Pytorch:/cvmfs/config.mila.quebec/modules/Tensorflow
INFO 2022-05-14 15:39:18,311 env.py:  50: MODULEPATH_ROOT:	/cvmfs/config.mila.quebec/modules
INFO 2022-05-14 15:39:18,312 env.py:  50: MODULERCFILE:	/cvmfs/config.mila.quebec/etc/lmod/modulerc.lua
INFO 2022-05-14 15:39:18,313 env.py:  50: MODULESHOME:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod
INFO 2022-05-14 15:39:18,315 env.py:  50: OLDPWD:	/home/mila/r/rajkuman/mina/mphil-vissl/configs/config/my_configs
INFO 2022-05-14 15:39:18,316 env.py:  50: PATH:	/home/mila/r/rajkuman/.conda/envs/vissl_env/bin:/home/mila/r/rajkuman/.local/bin:/usr/local/cuda/bin:/opt/bin:/usr/local/cuda/bin:/opt/bin:/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/condabin:/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin:/opt/slurm/bin:/sbin:/bin:/usr/sbin:/usr/bin
INFO 2022-05-14 15:39:18,317 env.py:  50: PKG_CONFIG_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/pkgconfig
INFO 2022-05-14 15:39:18,319 env.py:  50: PROCESSOR_ARCHITECTURE:	amd64
INFO 2022-05-14 15:39:18,320 env.py:  50: PWD:	/home/mila/r/rajkuman/mina/mphil-vissl
INFO 2022-05-14 15:39:18,321 env.py:  50: PYTHONNOUSERSITE:	True
INFO 2022-05-14 15:39:18,322 env.py:  50: PYTHONPATH:	/cvmfs/config.mila.quebec/etc/python.d/3.7
INFO 2022-05-14 15:39:18,324 env.py:  50: PYXTERM_DIMENSIONS:	80x25
INFO 2022-05-14 15:39:18,324 env.py:  50: RANK:	0
INFO 2022-05-14 15:39:18,326 env.py:  50: ROCR_VISIBLE_DEVICES:	0
INFO 2022-05-14 15:39:18,327 env.py:  50: SACCT_FORMAT:	User,JobID,Jobname,partition,state,time,start,end,elapsed,nnodes,ncpus,reqmem,alloctres,nodelist,workdir
INFO 2022-05-14 15:39:18,328 env.py:  50: SCRATCH:	/network/scratch/r/rajkuman
INFO 2022-05-14 15:39:18,329 env.py:  50: SHELL:	/bin/bash
INFO 2022-05-14 15:39:18,330 env.py:  50: SHLVL:	3
INFO 2022-05-14 15:39:18,332 env.py:  50: SINFO_FORMAT:	%18N %.6D %.11T %.4c %.8z %.6m %.8d %.6w %.22f %80E
INFO 2022-05-14 15:39:18,332 env.py:  50: SLURMD_NODENAME:	mila03
INFO 2022-05-14 15:39:18,334 env.py:  50: SLURM_CLUSTER_NAME:	mila
INFO 2022-05-14 15:39:18,335 env.py:  50: SLURM_CONF:	/etc/slurm/slurm.conf
INFO 2022-05-14 15:39:18,336 env.py:  50: SLURM_CPUS_ON_NODE:	4
INFO 2022-05-14 15:39:18,337 env.py:  50: SLURM_CPUS_PER_TASK:	4
INFO 2022-05-14 15:39:18,339 env.py:  50: SLURM_EXPORT_ENV:	PATH,LANG,USER,HOME,SHELL,JUPYTERHUB_API_TOKEN,JPY_API_TOKEN,JUPYTERHUB_CLIENT_ID,JUPYTERHUB_HOST,JUPYTERHUB_OAUTH_CALLBACK_URL,JUPYTERHUB_USER,JUPYTERHUB_SERVER_NAME,JUPYTERHUB_API_URL,JUPYTERHUB_ACTIVITY_URL,JUPYTERHUB_BASE_URL,JUPYTERHUB_SERVICE_PREFIX
INFO 2022-05-14 15:39:18,340 env.py:  50: SLURM_GET_USER_ENV:	1
INFO 2022-05-14 15:39:18,342 env.py:  50: SLURM_GTIDS:	0
INFO 2022-05-14 15:39:18,343 env.py:  50: SLURM_JOBID:	1821459
INFO 2022-05-14 15:39:18,344 env.py:  50: SLURM_JOB_ACCOUNT:	mila
INFO 2022-05-14 15:39:18,345 env.py:  50: SLURM_JOB_CPUS_PER_NODE:	4
INFO 2022-05-14 15:39:18,346 env.py:  50: SLURM_JOB_GID:	1471600619
INFO 2022-05-14 15:39:18,347 env.py:  50: SLURM_JOB_GPUS:	7
INFO 2022-05-14 15:39:18,348 env.py:  50: SLURM_JOB_ID:	1821459
INFO 2022-05-14 15:39:18,350 env.py:  50: SLURM_JOB_NAME:	jupyterhub-rajkuman
INFO 2022-05-14 15:39:18,351 env.py:  50: SLURM_JOB_NODELIST:	mila03
INFO 2022-05-14 15:39:18,353 env.py:  50: SLURM_JOB_NUM_NODES:	1
INFO 2022-05-14 15:39:18,354 env.py:  50: SLURM_JOB_PARTITION:	unkillable
INFO 2022-05-14 15:39:18,354 env.py:  50: SLURM_JOB_QOS:	normal
INFO 2022-05-14 15:39:18,356 env.py:  50: SLURM_JOB_UID:	1471600619
INFO 2022-05-14 15:39:18,357 env.py:  50: SLURM_JOB_USER:	rajkuman
INFO 2022-05-14 15:39:18,358 env.py:  50: SLURM_LOCALID:	0
INFO 2022-05-14 15:39:18,360 env.py:  50: SLURM_MEM_PER_NODE:	24000
INFO 2022-05-14 15:39:18,361 env.py:  50: SLURM_NNODES:	1
INFO 2022-05-14 15:39:18,362 env.py:  50: SLURM_NODEID:	0
INFO 2022-05-14 15:39:18,364 env.py:  50: SLURM_NODELIST:	mila03
INFO 2022-05-14 15:39:18,365 env.py:  50: SLURM_NODE_ALIASES:	(null)
INFO 2022-05-14 15:39:18,367 env.py:  50: SLURM_NPROCS:	1
INFO 2022-05-14 15:39:18,369 env.py:  50: SLURM_NTASKS:	1
INFO 2022-05-14 15:39:18,371 env.py:  50: SLURM_PRIO_PROCESS:	0
INFO 2022-05-14 15:39:18,371 env.py:  50: SLURM_PROCID:	0
INFO 2022-05-14 15:39:18,373 env.py:  50: SLURM_SUBMIT_DIR:	/var/lib/jupyterhub
INFO 2022-05-14 15:39:18,374 env.py:  50: SLURM_SUBMIT_HOST:	jupyter
INFO 2022-05-14 15:39:18,375 env.py:  50: SLURM_TASKS_PER_NODE:	1
INFO 2022-05-14 15:39:18,377 env.py:  50: SLURM_TASK_PID:	55997
INFO 2022-05-14 15:39:18,378 env.py:  50: SLURM_TMPDIR:	/Tmp/slurm.1821459.0
INFO 2022-05-14 15:39:18,379 env.py:  50: SLURM_TOPOLOGY_ADDR:	mila03
INFO 2022-05-14 15:39:18,381 env.py:  50: SLURM_TOPOLOGY_ADDR_PATTERN:	node
INFO 2022-05-14 15:39:18,382 env.py:  50: SLURM_WORKING_CLUSTER:	mila:slurm:6817:9216:109
INFO 2022-05-14 15:39:18,383 env.py:  50: SQUEUE_FORMAT:	%.8i %.8u %.12P %.14j %.3t %16S %.10M %.5D %.4C %.10b %.7m %N (%r) %k
INFO 2022-05-14 15:39:18,384 env.py:  50: S_COLORS:	auto
INFO 2022-05-14 15:39:18,385 env.py:  50: TERM:	xterm
INFO 2022-05-14 15:39:18,387 env.py:  50: TMPDIR:	/tmp
INFO 2022-05-14 15:39:18,388 env.py:  50: USER:	rajkuman
INFO 2022-05-14 15:39:18,389 env.py:  50: WORLD_SIZE:	1
INFO 2022-05-14 15:39:18,390 env.py:  50: XDG_SESSION_ID:	c520
INFO 2022-05-14 15:39:18,391 env.py:  50: _:	/home/mila/r/rajkuman/.conda/envs/vissl_env/bin/python
INFO 2022-05-14 15:39:18,393 env.py:  50: _CE_CONDA:	
INFO 2022-05-14 15:39:18,394 env.py:  50: _CE_M:	
INFO 2022-05-14 15:39:18,395 env.py:  50: _LMFILES_:	/cvmfs/config.mila.quebec/modules/Core/Mila.lua:/cvmfs/config.mila.quebec/modules/Core/gcc/7.4.0.lua:/cvmfs/config.mila.quebec/modules/Core/anaconda/3.lua
INFO 2022-05-14 15:39:18,397 env.py:  50: _ModuleTable001_:	X01vZHVsZVRhYmxlXz17WyJNVHZlcnNpb24iXT0zLFsiY19yZWJ1aWxkVGltZSJdPWZhbHNlLFsiY19zaG9ydFRpbWUiXT1mYWxzZSxkZXB0aFQ9e30sZmFtaWx5PXt9LG1UPXtNaWxhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL01pbGEubHVhIixbImZ1bGxOYW1lIl09Ik1pbGEiLFsibG9hZE9yZGVyIl09MSxwcm9wVD17bG1vZD17WyJzdGlja3kiXT0xLH0sfSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJNaWxhIix9LGFuYWNvbmRhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL2FuYWNvbmRhLzMubHVhIixbImZ1bGxOYW1lIl09ImFuYWNvbmRh
INFO 2022-05-14 15:39:18,398 env.py:  50: _ModuleTable002_:	LzMiLFsibG9hZE9yZGVyIl09Myxwcm9wVD17fSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJhbmFjb25kYS8zIix9LGdjYz17WyJmbiJdPSIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29yZS9nY2MvNy40LjAubHVhIixbImZ1bGxOYW1lIl09ImdjYy83LjQuMCIsWyJsb2FkT3JkZXIiXT0yLHByb3BUPXtsbW9kPXtbInN0aWNreSJdPTEsfSx9LFsic3RhY2tEZXB0aCJdPTAsWyJzdGF0dXMiXT0iYWN0aXZlIixbInVzZXJOYW1lIl09ImdjYy83LjQuMCIsfSx9LG1wYXRoQT17Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Nv
INFO 2022-05-14 15:39:18,399 env.py:  50: _ModuleTable003_:	bXBpbGVyIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Vudmlyb25tZW50cyIsIi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9DdWRhIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL1B5dG9yY2giLCIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvVGVuc29yZmxvdyIsfSxbInN5c3RlbUJhc2VNUEFUSCJdPSIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29yZTovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29tcGlsZXI6L2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Vudmlyb25tZW50czovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ3VkYTovY3Zt
INFO 2022-05-14 15:39:18,400 env.py:  50: _ModuleTable004_:	ZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvUHl0b3JjaDovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvVGVuc29yZmxvdyIsfQ==
INFO 2022-05-14 15:39:18,401 env.py:  50: _ModuleTable_Sz_:	4
INFO 2022-05-14 15:39:18,402 env.py:  50: __Init_Default_Modules:	1
INFO 2022-05-14 15:39:18,403 env.py:  50: __LMOD_REF_COUNT_CMAKE_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:1
INFO 2022-05-14 15:39:18,405 env.py:  50: __LMOD_REF_COUNT_CMAKE_PREFIX_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0:1
INFO 2022-05-14 15:39:18,406 env.py:  50: __LMOD_REF_COUNT_CPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/include:1
INFO 2022-05-14 15:39:18,407 env.py:  50: __LMOD_REF_COUNT_CSPYTHONPREFIXES:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3:1
INFO 2022-05-14 15:39:18,408 env.py:  50: __LMOD_REF_COUNT_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib:1
INFO 2022-05-14 15:39:18,409 env.py:  50: __LMOD_REF_COUNT_LOADEDMODULES:	Mila:1;gcc/7.4.0:1;anaconda/3:1
INFO 2022-05-14 15:39:18,411 env.py:  50: __LMOD_REF_COUNT_MANPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/share/man:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/share/man:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man:1
INFO 2022-05-14 15:39:18,411 env.py:  50: __LMOD_REF_COUNT_MODULEPATH:	/cvmfs/config.mila.quebec/modules/Core:1;/cvmfs/config.mila.quebec/modules/Compiler:1;/cvmfs/config.mila.quebec/modules/Environments:1;/cvmfs/config.mila.quebec/modules/Cuda:1;/cvmfs/config.mila.quebec/modules/Pytorch:1;/cvmfs/config.mila.quebec/modules/Tensorflow:1
INFO 2022-05-14 15:39:18,412 env.py:  50: __LMOD_REF_COUNT_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin:1;/opt/slurm/bin:1;/sbin:1;/bin:1;/usr/sbin:1;/usr/bin:1
INFO 2022-05-14 15:39:18,413 env.py:  50: __LMOD_REF_COUNT_PKG_CONFIG_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/pkgconfig:1
INFO 2022-05-14 15:39:18,414 env.py:  50: __LMOD_REF_COUNT_PYTHONPATH:	/cvmfs/config.mila.quebec/etc/python.d/3.7:1
INFO 2022-05-14 15:39:18,415 env.py:  50: __LMOD_REF_COUNT__LMFILES_:	/cvmfs/config.mila.quebec/modules/Core/Mila.lua:1;/cvmfs/config.mila.quebec/modules/Core/gcc/7.4.0.lua:1;/cvmfs/config.mila.quebec/modules/Core/anaconda/3.lua:1
INFO 2022-05-14 15:39:18,416 misc.py: 161: Set start method of multiprocessing to forkserver
INFO 2022-05-14 15:39:18,418 train.py: 105: Setting seed....
INFO 2022-05-14 15:39:18,419 misc.py: 173: MACHINE SEED: 0
INFO 2022-05-14 15:39:18,494 hydra_config.py: 132: Training with config:
INFO 2022-05-14 15:39:18,503 hydra_config.py: 141: {'CHECKPOINT': {'APPEND_DISTR_RUN_ID': False,
                'AUTO_RESUME': True,
                'BACKEND': 'disk',
                'CHECKPOINT_FREQUENCY': 1,
                'CHECKPOINT_ITER_FREQUENCY': -1,
                'DIR': './checkpoints/eval_trained_swav/0',
                'LATEST_CHECKPOINT_RESUME_FILE_NUM': 1,
                'OVERWRITE_EXISTING': False,
                'USE_SYMLINK_CHECKPOINT_FOR_RESUME': False},
 'CLUSTERFIT': {'CLUSTER_BACKEND': 'faiss',
                'DATA_LIMIT': -1,
                'DATA_LIMIT_SAMPLING': {'SEED': 0},
                'FEATURES': {'DATASET_NAME': '',
                             'DATA_PARTITION': 'TRAIN',
                             'DIMENSIONALITY_REDUCTION': 0,
                             'EXTRACT': False,
                             'LAYER_NAME': '',
                             'PATH': '.',
                             'TEST_PARTITION': 'TEST'},
                'NUM_CLUSTERS': 16000,
                'NUM_ITER': 50,
                'OUTPUT_DIR': '.'},
 'DATA': {'DDP_BUCKET_CAP_MB': 25,
          'ENABLE_ASYNC_GPU_COPY': True,
          'NUM_DATALOADER_WORKERS': 4,
          'PIN_MEMORY': True,
          'TEST': {'BASE_DATASET': 'generic_ssl',
                   'BATCHSIZE_PER_REPLICA': 512,
                   'COLLATE_FUNCTION': 'multicrop_collator',
                   'COLLATE_FUNCTION_PARAMS': {},
                   'COPY_DESTINATION_DIR': '/tmp/imagenet1k/',
                   'COPY_TO_LOCAL_DISK': False,
                   'DATASET_NAMES': ['CIFAR100'],
                   'DATA_LIMIT': -1,
                   'DATA_LIMIT_SAMPLING': {'IS_BALANCED': False,
                                           'SEED': 0,
                                           'SKIP_NUM_SAMPLES': 0},
                   'DATA_PATHS': [],
                   'DATA_SOURCES': ['disk_folder'],
                   'DEFAULT_GRAY_IMG_SIZE': 224,
                   'DROP_LAST': True,
                   'ENABLE_QUEUE_DATASET': False,
                   'INPUT_KEY_NAMES': ['data'],
                   'LABEL_PATHS': [],
                   'LABEL_SOURCES': [],
                   'LABEL_TYPE': 'sample_index',
                   'MMAP_MODE': True,
                   'NEW_IMG_PATH_PREFIX': '',
                   'RANDOM_SYNTHETIC_IMAGES': False,
                   'REMOVE_IMG_PATH_PREFIX': '',
                   'TARGET_KEY_NAMES': ['label'],
                   'TRANSFORMS': [{'crop_scales': [[0.08, 1]],
                                   'name': 'ImgPilToMultiCrop',
                                   'num_crops': [2],
                                   'size_crops': [32],
                                   'total_num_crops': 2},
                                  {'name': 'RandomHorizontalFlip', 'p': 0.5},
                                  {'name': 'ImgPilColorDistortion',
                                   'strength': 1.0},
                                  {'name': 'ImgPilGaussianBlur',
                                   'p': 0.5,
                                   'radius_max': 2.0,
                                   'radius_min': 0.1},
                                  {'name': 'ToTensor'},
                                  {'mean': [0.5074, 0.4867, 0.4411],
                                   'name': 'Normalize',
                                   'std': [0.2011, 0.1987, 0.202]}],
                   'USE_DEBUGGING_SAMPLER': False,
                   'USE_STATEFUL_DISTRIBUTED_SAMPLER': False},
          'TRAIN': {'BASE_DATASET': 'generic_ssl',
                    'BATCHSIZE_PER_REPLICA': 512,
                    'COLLATE_FUNCTION': 'multicrop_collator',
                    'COLLATE_FUNCTION_PARAMS': {},
                    'COPY_DESTINATION_DIR': '/tmp/imagenet1k/',
                    'COPY_TO_LOCAL_DISK': False,
                    'DATASET_NAMES': ['CIFAR100'],
                    'DATA_LIMIT': -1,
                    'DATA_LIMIT_SAMPLING': {'IS_BALANCED': False,
                                            'SEED': 0,
                                            'SKIP_NUM_SAMPLES': 0},
                    'DATA_PATHS': [],
                    'DATA_SOURCES': ['disk_folder'],
                    'DEFAULT_GRAY_IMG_SIZE': 224,
                    'DROP_LAST': True,
                    'ENABLE_QUEUE_DATASET': False,
                    'INPUT_KEY_NAMES': ['data'],
                    'LABEL_PATHS': [],
                    'LABEL_SOURCES': [],
                    'LABEL_TYPE': 'sample_index',
                    'MMAP_MODE': True,
                    'NEW_IMG_PATH_PREFIX': '',
                    'RANDOM_SYNTHETIC_IMAGES': False,
                    'REMOVE_IMG_PATH_PREFIX': '',
                    'TARGET_KEY_NAMES': ['label'],
                    'TRANSFORMS': [{'crop_scales': [[0.08, 1]],
                                    'name': 'ImgPilToMultiCrop',
                                    'num_crops': [2],
                                    'size_crops': [32],
                                    'total_num_crops': 2},
                                   {'name': 'RandomHorizontalFlip', 'p': 0.5},
                                   {'name': 'ImgPilColorDistortion',
                                    'strength': 1.0},
                                   {'name': 'ImgPilGaussianBlur',
                                    'p': 0.5,
                                    'radius_max': 2.0,
                                    'radius_min': 0.1},
                                   {'name': 'ToTensor'},
                                   {'mean': [0.5074, 0.4867, 0.4411],
                                    'name': 'Normalize',
                                    'std': [0.2011, 0.1987, 0.202]}],
                    'USE_DEBUGGING_SAMPLER': False,
                    'USE_STATEFUL_DISTRIBUTED_SAMPLER': False}},
 'DISTRIBUTED': {'BACKEND': 'nccl',
                 'BROADCAST_BUFFERS': True,
                 'INIT_METHOD': 'tcp',
                 'MANUAL_GRADIENT_REDUCTION': False,
                 'NCCL_DEBUG': False,
                 'NCCL_SOCKET_NTHREADS': '',
                 'NUM_NODES': 1,
                 'NUM_PROC_PER_NODE': 1,
                 'RUN_ID': 'auto'},
 'EXTRACT_FEATURES': {'CHUNK_THRESHOLD': 0, 'OUTPUT_DIR': ''},
 'HOOKS': {'CHECK_NAN': True,
           'LOG_GPU_STATS': True,
           'MEMORY_SUMMARY': {'DUMP_MEMORY_ON_EXCEPTION': False,
                              'LOG_ITERATION_NUM': 0,
                              'PRINT_MEMORY_SUMMARY': True},
           'MODEL_COMPLEXITY': {'COMPUTE_COMPLEXITY': False,
                                'INPUT_SHAPE': [3, 224, 224]},
           'PERF_STATS': {'MONITOR_PERF_STATS': True,
                          'PERF_STAT_FREQUENCY': -1,
                          'ROLLING_BTIME_FREQ': -1},
           'TENSORBOARD_SETUP': {'EXPERIMENT_LOG_DIR': 'tensorboard',
                                 'FLUSH_EVERY_N_MIN': 5,
                                 'LOG_DIR': '.',
                                 'LOG_PARAMS': True,
                                 'LOG_PARAMS_EVERY_N_ITERS': 310,
                                 'LOG_PARAMS_GRADIENTS': True,
                                 'USE_TENSORBOARD': False}},
 'IMG_RETRIEVAL': {'CROP_QUERY_ROI': False,
                   'DATASET_PATH': '',
                   'DEBUG_MODE': False,
                   'EVAL_BINARY_PATH': '',
                   'EVAL_DATASET_NAME': 'Paris',
                   'FEATS_PROCESSING_TYPE': '',
                   'GEM_POOL_POWER': 4.0,
                   'IMG_SCALINGS': [1],
                   'NORMALIZE_FEATURES': True,
                   'NUM_DATABASE_SAMPLES': -1,
                   'NUM_QUERY_SAMPLES': -1,
                   'NUM_TRAINING_SAMPLES': -1,
                   'N_PCA': 512,
                   'RESIZE_IMG': 1024,
                   'SAVE_FEATURES': False,
                   'SAVE_RETRIEVAL_RANKINGS_SCORES': True,
                   'SIMILARITY_MEASURE': 'cosine_similarity',
                   'SPATIAL_LEVELS': 3,
                   'TRAIN_DATASET_NAME': 'Oxford',
                   'TRAIN_PCA_WHITENING': True,
                   'USE_DISTRACTORS': False,
                   'WHITEN_IMG_LIST': ''},
 'LOG_FREQUENCY': 1,
 'LOSS': {'CrossEntropyLoss': {'ignore_index': -1},
          'barlow_twins_loss': {'embedding_dim': 8192,
                                'lambda_': 0.0051,
                                'scale_loss': 0.024},
          'bce_logits_multiple_output_single_target': {'normalize_output': False,
                                                       'reduction': 'none',
                                                       'world_size': 1},
          'cross_entropy_multiple_output_single_target': {'ignore_index': -1,
                                                          'normalize_output': False,
                                                          'reduction': 'mean',
                                                          'temperature': 1.0,
                                                          'weight': None},
          'deepclusterv2_loss': {'BATCHSIZE_PER_REPLICA': 256,
                                 'DROP_LAST': True,
                                 'kmeans_iters': 10,
                                 'memory_params': {'crops_for_mb': [0],
                                                   'embedding_dim': 128},
                                 'num_clusters': [3000, 3000, 3000],
                                 'num_crops': 2,
                                 'num_train_samples': -1,
                                 'temperature': 0.1},
          'dino_loss': {'crops_for_teacher': [0, 1],
                        'ema_center': 0.9,
                        'momentum': 0.996,
                        'normalize_last_layer': True,
                        'output_dim': 65536,
                        'student_temp': 0.1,
                        'teacher_temp_max': 0.07,
                        'teacher_temp_min': 0.04,
                        'teacher_temp_warmup_iters': 37500},
          'moco_loss': {'embedding_dim': 128,
                        'momentum': 0.999,
                        'queue_size': 65536,
                        'temperature': 0.2},
          'multicrop_simclr_info_nce_loss': {'buffer_params': {'effective_batch_size': 4096,
                                                               'embedding_dim': 128,
                                                               'world_size': 64},
                                             'num_crops': 2,
                                             'temperature': 0.1},
          'name': 'swav_loss',
          'nce_loss_with_memory': {'loss_type': 'nce',
                                   'loss_weights': [1.0],
                                   'memory_params': {'embedding_dim': 128,
                                                     'memory_size': -1,
                                                     'momentum': 0.5,
                                                     'norm_init': True,
                                                     'update_mem_on_forward': True},
                                   'negative_sampling_params': {'num_negatives': 16000,
                                                                'type': 'random'},
                                   'norm_constant': -1,
                                   'norm_embedding': True,
                                   'num_train_samples': -1,
                                   'temperature': 0.07,
                                   'update_mem_with_emb_index': -100},
          'simclr_info_nce_loss': {'buffer_params': {'effective_batch_size': 4096,
                                                     'embedding_dim': 128,
                                                     'world_size': 64},
                                   'temperature': 0.1},
          'swav_loss': {'crops_for_assign': [0, 1],
                        'embedding_dim': 128,
                        'epsilon': 0.05,
                        'normalize_last_layer': True,
                        'num_crops': 2,
                        'num_iters': 3,
                        'num_prototypes': [30],
                        'output_dir': './checkpoints/eval_trained_swav/0',
                        'queue': {'local_queue_length': 0,
                                  'queue_length': 0,
                                  'start_iter': 0},
                        'temp_hard_assignment_iters': 0,
                        'temperature': 0.5,
                        'use_double_precision': False},
          'swav_momentum_loss': {'crops_for_assign': [0, 1],
                                 'embedding_dim': 128,
                                 'epsilon': 0.05,
                                 'momentum': 0.99,
                                 'momentum_eval_mode_iter_start': 0,
                                 'normalize_last_layer': True,
                                 'num_crops': 2,
                                 'num_iters': 3,
                                 'num_prototypes': [3000],
                                 'queue': {'local_queue_length': 0,
                                           'queue_length': 0,
                                           'start_iter': 0},
                                 'temperature': 0.1,
                                 'use_double_precision': False}},
 'MACHINE': {'DEVICE': 'gpu'},
 'METERS': {'accuracy_list_meter': {'meter_names': [],
                                    'num_meters': 1,
                                    'topk_values': [1]},
            'enable_training_meter': True,
            'mean_ap_list_meter': {'max_cpu_capacity': -1,
                                   'meter_names': [],
                                   'num_classes': 9605,
                                   'num_meters': 1},
            'model_output_mask': False,
            'name': '',
            'names': [],
            'precision_at_k_list_meter': {'meter_names': [],
                                          'num_meters': 1,
                                          'topk_values': [1]},
            'recall_at_k_list_meter': {'meter_names': [],
                                       'num_meters': 1,
                                       'topk_values': [1]}},
 'MODEL': {'ACTIVATION_CHECKPOINTING': {'NUM_ACTIVATION_CHECKPOINTING_SPLITS': 2,
                                        'USE_ACTIVATION_CHECKPOINTING': False},
           'AMP_PARAMS': {'AMP_ARGS': {'opt_level': 'O1'},
                          'AMP_TYPE': 'apex',
                          'USE_AMP': False},
           'BASE_MODEL_NAME': 'multi_input_output_model',
           'CUDA_CACHE': {'CLEAR_CUDA_CACHE': False, 'CLEAR_FREQ': 100},
           'FEATURE_EVAL_SETTINGS': {'EVAL_MODE_ON': True,
                                     'EVAL_TRUNK_AND_HEAD': False,
                                     'EXTRACT_TRUNK_FEATURES_ONLY': False,
                                     'FREEZE_TRUNK_AND_HEAD': False,
                                     'FREEZE_TRUNK_ONLY': False,
                                     'LINEAR_EVAL_FEAT_POOL_OPS_MAP': [],
                                     'SHOULD_FLATTEN_FEATS': True},
           'FSDP_CONFIG': {'AUTO_WRAP_THRESHOLD': 0,
                           'bucket_cap_mb': 0,
                           'clear_autocast_cache': True,
                           'compute_dtype': torch.float32,
                           'flatten_parameters': True,
                           'fp32_reduce_scatter': False,
                           'mixed_precision': True,
                           'verbose': True},
           'GRAD_CLIP': {'MAX_NORM': 1, 'NORM_TYPE': 2, 'USE_GRAD_CLIP': False},
           'HEAD': {'BATCHNORM_EPS': 1e-05,
                    'BATCHNORM_MOMENTUM': 0.1,
                    'PARAMS': [['swav_head',
                                {'dims': [512, 512, 128],
                                 'num_clusters': [30],
                                 'use_bn': True}]],
                    'PARAMS_MULTIPLIER': 1.0},
           'INPUT_TYPE': 'rgb',
           'MULTI_INPUT_HEAD_MAPPING': [],
           'NON_TRAINABLE_PARAMS': [],
           'SHARDED_DDP_SETUP': {'USE_SDP': False, 'reduce_buffer_size': -1},
           'SINGLE_PASS_EVERY_CROP': False,
           'SYNC_BN_CONFIG': {'CONVERT_BN_TO_SYNC_BN': False,
                              'GROUP_SIZE': -1,
                              'SYNC_BN_TYPE': 'pytorch'},
           'TEMP_FROZEN_PARAMS_ITER_MAP': [['module.heads.0.prototypes0.weight',
                                            900]],
           'TRUNK': {'CONVIT': {'CLASS_TOKEN_IN_LOCAL_LAYERS': False,
                                'LOCALITY_DIM': 10,
                                'LOCALITY_STRENGTH': 1.0,
                                'N_GPSA_LAYERS': 10,
                                'USE_LOCAL_INIT': True},
                     'EFFICIENT_NETS': {},
                     'NAME': 'resnet',
                     'REGNET': {},
                     'RESNETS': {'BLOCK': 'BasicBlock',
                                 'CONV1_KERNEL': 3,
                                 'CONV1_PADDING': 1,
                                 'CONV1_STRIDE': 1,
                                 'DEPTH': 18,
                                 'GROUPNORM_GROUPS': 32,
                                 'GROUPS': 1,
                                 'LAYER4_STRIDE': 2,
                                 'MAXPOOL': False,
                                 'NORM': 'BatchNorm',
                                 'STANDARDIZE_CONVOLUTIONS': False,
                                 'WIDTH_MULTIPLIER': 1,
                                 'WIDTH_PER_GROUP': 64,
                                 'ZERO_INIT_RESIDUAL': False},
                     'VISION_TRANSFORMERS': {'ATTENTION_DROPOUT_RATE': 0,
                                             'CLASSIFIER': 'token',
                                             'DROPOUT_RATE': 0,
                                             'DROP_PATH_RATE': 0,
                                             'HIDDEN_DIM': 768,
                                             'IMAGE_SIZE': 224,
                                             'MLP_DIM': 3072,
                                             'NUM_HEADS': 12,
                                             'NUM_LAYERS': 12,
                                             'PATCH_SIZE': 16,
                                             'QKV_BIAS': False,
                                             'QK_SCALE': False,
                                             'name': None},
                     'XCIT': {'ATTENTION_DROPOUT_RATE': 0,
                              'DROPOUT_RATE': 0,
                              'DROP_PATH_RATE': 0.05,
                              'ETA': 1,
                              'HIDDEN_DIM': 384,
                              'IMAGE_SIZE': 224,
                              'NUM_HEADS': 8,
                              'NUM_LAYERS': 12,
                              'PATCH_SIZE': 16,
                              'QKV_BIAS': True,
                              'QK_SCALE': False,
                              'TOKENS_NORM': True,
                              'name': None}},
           'WEIGHTS_INIT': {'APPEND_PREFIX': '',
                            'PARAMS_FILE': '',
                            'REMOVE_PREFIX': '',
                            'SKIP_LAYERS': ['num_batches_tracked'],
                            'STATE_DICT_KEY_NAME': 'classy_state_dict'},
           '_MODEL_INIT_SEED': 0},
 'MONITORING': {'MONITOR_ACTIVATION_STATISTICS': 0},
 'MULTI_PROCESSING_METHOD': 'forkserver',
 'NEAREST_NEIGHBOR': {'L2_NORM_FEATS': False, 'SIGMA': 0.1, 'TOPK': 200},
 'OPTIMIZER': {'betas': [0.9, 0.999],
               'construct_single_param_group_only': False,
               'head_optimizer_params': {'use_different_lr': False,
                                         'use_different_wd': False,
                                         'weight_decay': 1e-06},
               'larc_config': {'clip': False,
                               'eps': 1e-08,
                               'trust_coefficient': 0.001},
               'momentum': 0.9,
               'name': 'sgd',
               'nesterov': False,
               'non_regularized_parameters': [],
               'num_epochs': 1,
               'param_schedulers': {'lr': {'auto_lr_scaling': {'auto_scale': False,
                                                               'base_lr_batch_size': 256,
                                                               'base_value': 0.1,
                                                               'scaling_type': 'linear'},
                                           'end_value': 0.0006,
                                           'interval_scaling': [],
                                           'lengths': [],
                                           'milestones': [30, 60],
                                           'name': 'cosine',
                                           'schedulers': [],
                                           'start_value': 0.06,
                                           'update_interval': 'epoch',
                                           'value': 0.1,
                                           'values': [0.1, 0.01, 0.001]},
                                    'lr_head': {'auto_lr_scaling': {'auto_scale': False,
                                                                    'base_lr_batch_size': 256,
                                                                    'base_value': 0.1,
                                                                    'scaling_type': 'linear'},
                                                'end_value': 0.0006,
                                                'interval_scaling': [],
                                                'lengths': [],
                                                'milestones': [30, 60],
                                                'name': 'cosine',
                                                'schedulers': [],
                                                'start_value': 0.06,
                                                'update_interval': 'epoch',
                                                'value': 0.1,
                                                'values': [0.1, 0.01, 0.001]}},
               'regularize_bias': True,
               'regularize_bn': False,
               'use_larc': True,
               'use_zero': False,
               'weight_decay': 1e-06},
 'PROFILING': {'MEMORY_PROFILING': {'TRACK_BY_LAYER_MEMORY': False},
               'NUM_ITERATIONS': 10,
               'OUTPUT_FOLDER': '.',
               'PROFILED_RANKS': [0, 1],
               'RUNTIME_PROFILING': {'LEGACY_PROFILER': False,
                                     'PROFILE_CPU': True,
                                     'PROFILE_GPU': True,
                                     'USE_PROFILER': False},
               'START_ITERATION': 0,
               'STOP_TRAINING_AFTER_PROFILING': False,
               'WARMUP_ITERATIONS': 0},
 'REPRODUCIBILITY': {'CUDDN_DETERMINISTIC': False},
 'SEED_VALUE': 0,
 'SLURM': {'ADDITIONAL_PARAMETERS': {},
           'COMMENT': 'vissl job',
           'CONSTRAINT': '',
           'LOG_FOLDER': '.',
           'MEM_GB': 250,
           'NAME': 'vissl',
           'NUM_CPU_PER_PROC': 8,
           'PARTITION': '',
           'PORT_ID': 40050,
           'TIME_HOURS': 72,
           'TIME_MINUTES': 0,
           'USE_SLURM': False},
 'SVM': {'cls_list': [],
         'costs': {'base': -1.0,
                   'costs_list': [0.1, 0.01],
                   'power_range': [4, 20]},
         'cross_val_folds': 3,
         'dual': True,
         'force_retrain': False,
         'loss': 'squared_hinge',
         'low_shot': {'dataset_name': 'voc',
                      'k_values': [1, 2, 4, 8, 16, 32, 64, 96],
                      'sample_inds': [1, 2, 3, 4, 5]},
         'max_iter': 2000,
         'normalize': True,
         'penalty': 'l2'},
 'TEST_EVERY_NUM_EPOCH': 1,
 'TEST_MODEL': True,
 'TEST_ONLY': True,
 'TRAINER': {'TASK_NAME': 'self_supervision_task',
             'TRAIN_STEP_NAME': 'standard_train_step'},
 'VERBOSE': False,
 'WEIGHTS_INIT': {'PARAMS_FILE': './checkpoints/trained_swav/0/model_phase100.torch',
                  'STATE_DICT_KEY_NAME': 'classy_state_dict'}}
INFO 2022-05-14 15:39:35,985 train.py: 117: System config:
-------------------  ---------------------------------------------------------------------------------------------------------------
sys.platform         linux
Python               3.8.13 (default, Mar 28 2022, 11:38:47) [GCC 7.5.0]
numpy                1.19.5
Pillow               9.0.1
vissl                0.1.6 @/home/mila/r/rajkuman/mina/mphil-vissl/vissl
GPU available        True
GPU 0                Tesla V100-SXM2-32GB-LS
CUDA_HOME            None
torchvision          0.9.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/torchvision
hydra                1.0.7 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/hydra_core-1.0.7-py3.8.egg/hydra
classy_vision        0.7.0.dev @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/classy_vision
tensorboard          2.9.0
apex                 0.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/apex
PyTorch              1.8.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/torch
PyTorch debug build  False
-------------------  ---------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.7.0 (Git Hash 7aed236906b1f7a05c0917e5257a1af05e9ff683)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.8.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

CPU info:
-------------------  -----------------------------------------
Architecture         x86_64
CPU op-mode(s)       32-bit, 64-bit
Byte Order           Little Endian
CPU(s)               80
On-line CPU(s) list  0-79
Thread(s) per core   2
Core(s) per socket   20
Socket(s)            2
NUMA node(s)         2
Vendor ID            GenuineIntel
CPU family           6
Model                79
Model name           Intel(R) Xeon(R) CPU E5-2698 v4 @ 2.20GHz
Stepping             1
CPU MHz              2714.995
CPU max MHz          3600.0000
CPU min MHz          1200.0000
BogoMIPS             4389.95
Virtualization       VT-x
L1d cache            32K
L1i cache            32K
L2 cache             256K
L3 cache             51200K
NUMA node0 CPU(s)    0-19,40-59
NUMA node1 CPU(s)    20-39,60-79
-------------------  -----------------------------------------
INFO 2022-05-14 15:39:35,996 trainer_main.py: 112: Using Distributed init method: tcp://localhost:43263, world_size: 1, rank: 0
INFO 2022-05-14 15:39:36,007 distributed_c10d.py: 187: Added key: store_based_barrier_key:1 to store for rank: 0
INFO 2022-05-14 15:39:36,008 trainer_main.py: 130: | initialized host mila03.server.mila.quebec as rank 0 (0)
INFO 2022-05-14 15:39:47,871 train_task.py: 181: Not using Automatic Mixed Precision
INFO 2022-05-14 15:39:47,872 train_task.py: 455: Building model....
INFO 2022-05-14 15:39:47,875 resnext.py:  66: ResNeXT trunk, supports activation checkpointing. Deactivated
INFO 2022-05-14 15:39:47,876 resnext.py:  93: Building model: ResNeXt18-1x64d-w1-BatchNorm2d
INFO 2022-05-14 15:39:48,264 train_task.py: 656: Broadcast model BN buffers from primary on every forward pass
INFO 2022-05-14 15:39:48,265 classification_task.py: 387: Synchronized Batch Normalization is disabled
INFO 2022-05-14 15:39:48,286 optimizer_helper.py: 293: 
Trainable params: 67, 
Non-Trainable params: 0, 
Trunk Regularized Parameters: 20, 
Trunk Unregularized Parameters 40, 
Head Regularized Parameters: 5, 
Head Unregularized Parameters: 2 
Remaining Regularized Parameters: 0 
Remaining Unregularized Parameters: 0
INFO 2022-05-14 15:39:48,291 img_pil_color_distortion.py:  56: ImgPilColorDistortion | Using strength: 1.0
INFO 2022-05-14 15:39:48,295 ssl_dataset.py: 156: Rank: 0 split: TEST Data files:
['data/CIFAR-100-dataset/test']
INFO 2022-05-14 15:39:48,296 ssl_dataset.py: 159: Rank: 0 split: TEST Label files:
['data/CIFAR-100-dataset/test']
INFO 2022-05-14 15:39:48,721 disk_dataset.py:  86: Loaded 10000 samples from folder data/CIFAR-100-dataset/test
INFO 2022-05-14 15:39:48,722 misc.py: 161: Set start method of multiprocessing to forkserver
INFO 2022-05-14 15:39:48,722 __init__.py: 126: Created the Distributed Sampler....
INFO 2022-05-14 15:39:48,723 __init__.py: 101: Distributed Sampler config:
{'num_replicas': 1, 'rank': 0, 'epoch': 0, 'num_samples': 10000, 'total_size': 10000, 'shuffle': True, 'seed': 0}
INFO 2022-05-14 15:39:48,724 __init__.py: 215: Wrapping the dataloader to async device copies
INFO 2022-05-14 15:39:48,726 train_task.py: 384: Building loss...
INFO 2022-05-14 15:39:48,729 trainer_main.py: 268: Training 1 epochs
INFO 2022-05-14 15:39:48,729 trainer_main.py: 269: One epoch = 19 iterations.
INFO 2022-05-14 15:39:48,731 trainer_main.py: 270: Total 10000 samples in one epoch
INFO 2022-05-14 15:39:48,732 trainer_main.py: 276: Total 19 iterations for training
INFO 2022-05-14 15:39:48,881 logger.py:  84: Sat May 14 15:39:48 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.82.01    Driver Version: 470.82.01    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  Off  | 00000000:8A:00.0 Off |                    0 |
| N/A   30C    P0    47W / 163W |   1202MiB / 32510MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A     30049      C   python                           1199MiB |
+-----------------------------------------------------------------------------+

INFO 2022-05-14 15:39:48,884 trainer_main.py: 173: Model is:
 Classy <class 'vissl.models.base_ssl_model.BaseSSLMultiInputOutputModel'>:
BaseSSLMultiInputOutputModel(
  (_heads): ModuleDict()
  (trunk): ResNeXt(
    (_feature_blocks): ModuleDict(
      (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv1_relu): ReLU(inplace=True)
      (maxpool): Identity()
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(<SUPPORTED_L4_STRIDE.two: 2>, <SUPPORTED_L4_STRIDE.two: 2>), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(<SUPPORTED_L4_STRIDE.two: 2>, <SUPPORTED_L4_STRIDE.two: 2>), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (flatten): Flatten()
    )
  )
  (heads): ModuleList(
    (0): SwAVPrototypesHead(
      (projection_head): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Linear(in_features=512, out_features=128, bias=True)
      )
      (prototypes0): Linear(in_features=128, out_features=30, bias=False)
    )
  )
)
INFO 2022-05-14 15:39:48,885 trainer_main.py: 174: Loss is: { 'embedding_dim': 128,
  'epsilon': 0.05,
  'local_queue_length': 0,
  'name': 'SwAVLoss',
  'nmb_sinkhornknopp_iters': 3,
  'num_crops': 2,
  'num_prototypes': [30],
  'temp_hard_assignment_iters': 0,
  'temperature': 0.5,
  'use_double_precision': False}
INFO 2022-05-14 15:39:48,886 trainer_main.py: 175: Starting training....
INFO 2022-05-14 15:39:48,888 __init__.py: 101: Distributed Sampler config:
{'num_replicas': 1, 'rank': 0, 'epoch': 0, 'num_samples': 10000, 'total_size': 10000, 'shuffle': True, 'seed': 0}
INFO 2022-05-14 15:40:30,361 distributed_launcher.py: 168: All Done!
INFO 2022-05-14 15:40:30,362 logger.py:  73: Shutting down loggers...
INFO 2022-05-14 15:41:35,766 train.py:  94: Env set for rank: 0, dist_rank: 0
INFO 2022-05-14 15:41:35,768 env.py:  50: ARCH:	x86_64
INFO 2022-05-14 15:41:35,769 env.py:  50: BASH_ENV:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/init/bash
INFO 2022-05-14 15:41:35,771 env.py:  50: BASH_FUNC_ml%%:	() {  eval $($LMOD_DIR/ml_cmd "$@")
}
INFO 2022-05-14 15:41:35,773 env.py:  50: BASH_FUNC_module%%:	() {  eval $($LMOD_CMD bash "$@") && eval $(${LMOD_SETTARG_CMD:-:} -s sh)
}
INFO 2022-05-14 15:41:35,775 env.py:  50: CMAKE_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64
INFO 2022-05-14 15:41:35,776 env.py:  50: CMAKE_PREFIX_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0
INFO 2022-05-14 15:41:35,777 env.py:  50: COLUMNS:	202
INFO 2022-05-14 15:41:35,778 env.py:  50: CONDA_ACTIVATE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/etc/profile.d/conda.sh
INFO 2022-05-14 15:41:35,780 env.py:  50: CONDA_DEFAULT_ENV:	vissl_env
INFO 2022-05-14 15:41:35,781 env.py:  50: CONDA_EXE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin/conda
INFO 2022-05-14 15:41:35,782 env.py:  50: CONDA_PREFIX:	/home/mila/r/rajkuman/.conda/envs/vissl_env
INFO 2022-05-14 15:41:35,784 env.py:  50: CONDA_PROMPT_MODIFIER:	(vissl_env) 
INFO 2022-05-14 15:41:35,784 env.py:  50: CONDA_PYTHON_EXE:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin/python
INFO 2022-05-14 15:41:35,786 env.py:  50: CONDA_SHLVL:	1
INFO 2022-05-14 15:41:35,787 env.py:  50: CPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/include
INFO 2022-05-14 15:41:35,789 env.py:  50: CSPYTHONPREFIXES:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3
INFO 2022-05-14 15:41:35,790 env.py:  50: CUDA_VISIBLE_DEVICES:	0
INFO 2022-05-14 15:41:35,792 env.py:  50: ENVIRONMENT:	BATCH
INFO 2022-05-14 15:41:35,793 env.py:  50: GPU_DEVICE_ORDINAL:	0
INFO 2022-05-14 15:41:35,794 env.py:  50: HOME:	/home/mila/r/rajkuman
INFO 2022-05-14 15:41:35,795 env.py:  50: HOSTNAME:	mila03
INFO 2022-05-14 15:41:35,797 env.py:  50: ID:	debian
INFO 2022-05-14 15:41:35,798 env.py:  50: JPY_API_TOKEN:	834ce4aa2de248308d2103afece2e12b
INFO 2022-05-14 15:41:35,799 env.py:  50: JUPYTERHUB_ACTIVITY_URL:	http://172.16.2.123:8081/hub/api/users/rajkuman/activity
INFO 2022-05-14 15:41:35,801 env.py:  50: JUPYTERHUB_API_TOKEN:	834ce4aa2de248308d2103afece2e12b
INFO 2022-05-14 15:41:35,802 env.py:  50: JUPYTERHUB_API_URL:	http://172.16.2.123:8081/hub/api
INFO 2022-05-14 15:41:35,803 env.py:  50: JUPYTERHUB_BASE_URL:	/
INFO 2022-05-14 15:41:35,804 env.py:  50: JUPYTERHUB_CLIENT_ID:	jupyterhub-user-rajkuman
INFO 2022-05-14 15:41:35,806 env.py:  50: JUPYTERHUB_HOST:	
INFO 2022-05-14 15:41:35,807 env.py:  50: JUPYTERHUB_OAUTH_CALLBACK_URL:	/user/rajkuman/oauth_callback
INFO 2022-05-14 15:41:35,809 env.py:  50: JUPYTERHUB_SERVER_NAME:	
INFO 2022-05-14 15:41:35,810 env.py:  50: JUPYTERHUB_SERVICE_PREFIX:	/user/rajkuman/
INFO 2022-05-14 15:41:35,811 env.py:  50: JUPYTERHUB_USER:	rajkuman
INFO 2022-05-14 15:41:35,813 env.py:  50: JUPYTER_SERVER_ROOT:	/home/mila/r/rajkuman
INFO 2022-05-14 15:41:35,814 env.py:  50: JUPYTER_SERVER_URL:	http://0.0.0.0:57133/user/rajkuman/
INFO 2022-05-14 15:41:35,815 env.py:  50: KERNEL_LAUNCH_TIMEOUT:	40
INFO 2022-05-14 15:41:35,816 env.py:  50: LANG:	en_US.UTF-8
INFO 2022-05-14 15:41:35,817 env.py:  50: LANGUAGE:	en_CA:en
INFO 2022-05-14 15:41:35,819 env.py:  50: LESSCLOSE:	/bin/lesspipe %s %s
INFO 2022-05-14 15:41:35,820 env.py:  50: LESSOPEN:	| /bin/lesspipe %s
INFO 2022-05-14 15:41:35,821 env.py:  50: LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib
INFO 2022-05-14 15:41:35,822 env.py:  50: LINES:	50
INFO 2022-05-14 15:41:35,824 env.py:  50: LMOD_CMD:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec/lmod
INFO 2022-05-14 15:41:35,825 env.py:  50: LMOD_DIR:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec
INFO 2022-05-14 15:41:35,827 env.py:  50: LMOD_PACKAGE_PATH:	/cvmfs/config.mila.quebec/etc/lmod/
INFO 2022-05-14 15:41:35,829 env.py:  50: LMOD_PKG:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod
INFO 2022-05-14 15:41:35,830 env.py:  50: LMOD_ROOT:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod
INFO 2022-05-14 15:41:35,832 env.py:  50: LMOD_SETTARG_FULL_SUPPORT:	no
INFO 2022-05-14 15:41:35,833 env.py:  50: LMOD_SYSTEM_DEFAULT_MODULES:	Mila:gcc/7.4.0
INFO 2022-05-14 15:41:35,835 env.py:  50: LMOD_VERSION:	8.3.17
INFO 2022-05-14 15:41:35,836 env.py:  50: LMOD_sys:	Linux
INFO 2022-05-14 15:41:35,837 env.py:  50: LOADEDMODULES:	Mila:gcc/7.4.0:anaconda/3
INFO 2022-05-14 15:41:35,838 env.py:  50: LOCAL_RANK:	0
INFO 2022-05-14 15:41:35,840 env.py:  50: LOGNAME:	rajkuman
INFO 2022-05-14 15:41:35,841 env.py:  50: LS_COLORS:	rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
INFO 2022-05-14 15:41:35,844 env.py:  50: MAIL:	/var/mail/rajkuman
INFO 2022-05-14 15:41:35,845 env.py:  50: MANPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/share/man:/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/share/man:/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man::
INFO 2022-05-14 15:41:35,846 env.py:  50: MODULEPATH:	/cvmfs/config.mila.quebec/modules/Core:/cvmfs/config.mila.quebec/modules/Compiler:/cvmfs/config.mila.quebec/modules/Environments:/cvmfs/config.mila.quebec/modules/Cuda:/cvmfs/config.mila.quebec/modules/Pytorch:/cvmfs/config.mila.quebec/modules/Tensorflow
INFO 2022-05-14 15:41:35,847 env.py:  50: MODULEPATH_ROOT:	/cvmfs/config.mila.quebec/modules
INFO 2022-05-14 15:41:35,849 env.py:  50: MODULERCFILE:	/cvmfs/config.mila.quebec/etc/lmod/modulerc.lua
INFO 2022-05-14 15:41:35,851 env.py:  50: MODULESHOME:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod
INFO 2022-05-14 15:41:35,853 env.py:  50: OLDPWD:	/home/mila/r/rajkuman/mina/mphil-vissl/configs/config/my_configs
INFO 2022-05-14 15:41:35,854 env.py:  50: PATH:	/home/mila/r/rajkuman/.conda/envs/vissl_env/bin:/home/mila/r/rajkuman/.local/bin:/usr/local/cuda/bin:/opt/bin:/usr/local/cuda/bin:/opt/bin:/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/condabin:/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin:/opt/slurm/bin:/sbin:/bin:/usr/sbin:/usr/bin
INFO 2022-05-14 15:41:35,856 env.py:  50: PKG_CONFIG_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/pkgconfig
INFO 2022-05-14 15:41:35,858 env.py:  50: PROCESSOR_ARCHITECTURE:	amd64
INFO 2022-05-14 15:41:35,859 env.py:  50: PWD:	/home/mila/r/rajkuman/mina/mphil-vissl
INFO 2022-05-14 15:41:35,861 env.py:  50: PYTHONNOUSERSITE:	True
INFO 2022-05-14 15:41:35,862 env.py:  50: PYTHONPATH:	/cvmfs/config.mila.quebec/etc/python.d/3.7
INFO 2022-05-14 15:41:35,864 env.py:  50: PYXTERM_DIMENSIONS:	80x25
INFO 2022-05-14 15:41:35,865 env.py:  50: RANK:	0
INFO 2022-05-14 15:41:35,867 env.py:  50: ROCR_VISIBLE_DEVICES:	0
INFO 2022-05-14 15:41:35,868 env.py:  50: SACCT_FORMAT:	User,JobID,Jobname,partition,state,time,start,end,elapsed,nnodes,ncpus,reqmem,alloctres,nodelist,workdir
INFO 2022-05-14 15:41:35,869 env.py:  50: SCRATCH:	/network/scratch/r/rajkuman
INFO 2022-05-14 15:41:35,870 env.py:  50: SHELL:	/bin/bash
INFO 2022-05-14 15:41:35,872 env.py:  50: SHLVL:	3
INFO 2022-05-14 15:41:35,872 env.py:  50: SINFO_FORMAT:	%18N %.6D %.11T %.4c %.8z %.6m %.8d %.6w %.22f %80E
INFO 2022-05-14 15:41:35,874 env.py:  50: SLURMD_NODENAME:	mila03
INFO 2022-05-14 15:41:35,875 env.py:  50: SLURM_CLUSTER_NAME:	mila
INFO 2022-05-14 15:41:35,876 env.py:  50: SLURM_CONF:	/etc/slurm/slurm.conf
INFO 2022-05-14 15:41:35,877 env.py:  50: SLURM_CPUS_ON_NODE:	4
INFO 2022-05-14 15:41:35,878 env.py:  50: SLURM_CPUS_PER_TASK:	4
INFO 2022-05-14 15:41:35,880 env.py:  50: SLURM_EXPORT_ENV:	PATH,LANG,USER,HOME,SHELL,JUPYTERHUB_API_TOKEN,JPY_API_TOKEN,JUPYTERHUB_CLIENT_ID,JUPYTERHUB_HOST,JUPYTERHUB_OAUTH_CALLBACK_URL,JUPYTERHUB_USER,JUPYTERHUB_SERVER_NAME,JUPYTERHUB_API_URL,JUPYTERHUB_ACTIVITY_URL,JUPYTERHUB_BASE_URL,JUPYTERHUB_SERVICE_PREFIX
INFO 2022-05-14 15:41:35,881 env.py:  50: SLURM_GET_USER_ENV:	1
INFO 2022-05-14 15:41:35,883 env.py:  50: SLURM_GTIDS:	0
INFO 2022-05-14 15:41:35,884 env.py:  50: SLURM_JOBID:	1821459
INFO 2022-05-14 15:41:35,886 env.py:  50: SLURM_JOB_ACCOUNT:	mila
INFO 2022-05-14 15:41:35,887 env.py:  50: SLURM_JOB_CPUS_PER_NODE:	4
INFO 2022-05-14 15:41:35,889 env.py:  50: SLURM_JOB_GID:	1471600619
INFO 2022-05-14 15:41:35,891 env.py:  50: SLURM_JOB_GPUS:	7
INFO 2022-05-14 15:41:35,892 env.py:  50: SLURM_JOB_ID:	1821459
INFO 2022-05-14 15:41:35,894 env.py:  50: SLURM_JOB_NAME:	jupyterhub-rajkuman
INFO 2022-05-14 15:41:35,895 env.py:  50: SLURM_JOB_NODELIST:	mila03
INFO 2022-05-14 15:41:35,897 env.py:  50: SLURM_JOB_NUM_NODES:	1
INFO 2022-05-14 15:41:35,898 env.py:  50: SLURM_JOB_PARTITION:	unkillable
INFO 2022-05-14 15:41:35,899 env.py:  50: SLURM_JOB_QOS:	normal
INFO 2022-05-14 15:41:35,900 env.py:  50: SLURM_JOB_UID:	1471600619
INFO 2022-05-14 15:41:35,900 env.py:  50: SLURM_JOB_USER:	rajkuman
INFO 2022-05-14 15:41:35,901 env.py:  50: SLURM_LOCALID:	0
INFO 2022-05-14 15:41:35,903 env.py:  50: SLURM_MEM_PER_NODE:	24000
INFO 2022-05-14 15:41:35,904 env.py:  50: SLURM_NNODES:	1
INFO 2022-05-14 15:41:35,906 env.py:  50: SLURM_NODEID:	0
INFO 2022-05-14 15:41:35,906 env.py:  50: SLURM_NODELIST:	mila03
INFO 2022-05-14 15:41:35,908 env.py:  50: SLURM_NODE_ALIASES:	(null)
INFO 2022-05-14 15:41:35,908 env.py:  50: SLURM_NPROCS:	1
INFO 2022-05-14 15:41:35,910 env.py:  50: SLURM_NTASKS:	1
INFO 2022-05-14 15:41:35,911 env.py:  50: SLURM_PRIO_PROCESS:	0
INFO 2022-05-14 15:41:35,912 env.py:  50: SLURM_PROCID:	0
INFO 2022-05-14 15:41:35,914 env.py:  50: SLURM_SUBMIT_DIR:	/var/lib/jupyterhub
INFO 2022-05-14 15:41:35,915 env.py:  50: SLURM_SUBMIT_HOST:	jupyter
INFO 2022-05-14 15:41:35,917 env.py:  50: SLURM_TASKS_PER_NODE:	1
INFO 2022-05-14 15:41:35,918 env.py:  50: SLURM_TASK_PID:	55997
INFO 2022-05-14 15:41:35,919 env.py:  50: SLURM_TMPDIR:	/Tmp/slurm.1821459.0
INFO 2022-05-14 15:41:35,921 env.py:  50: SLURM_TOPOLOGY_ADDR:	mila03
INFO 2022-05-14 15:41:35,922 env.py:  50: SLURM_TOPOLOGY_ADDR_PATTERN:	node
INFO 2022-05-14 15:41:35,923 env.py:  50: SLURM_WORKING_CLUSTER:	mila:slurm:6817:9216:109
INFO 2022-05-14 15:41:35,925 env.py:  50: SQUEUE_FORMAT:	%.8i %.8u %.12P %.14j %.3t %16S %.10M %.5D %.4C %.10b %.7m %N (%r) %k
INFO 2022-05-14 15:41:35,927 env.py:  50: S_COLORS:	auto
INFO 2022-05-14 15:41:35,928 env.py:  50: TERM:	xterm
INFO 2022-05-14 15:41:35,930 env.py:  50: TMPDIR:	/tmp
INFO 2022-05-14 15:41:35,931 env.py:  50: USER:	rajkuman
INFO 2022-05-14 15:41:35,932 env.py:  50: WORLD_SIZE:	1
INFO 2022-05-14 15:41:35,933 env.py:  50: XDG_SESSION_ID:	c520
INFO 2022-05-14 15:41:35,934 env.py:  50: _:	/home/mila/r/rajkuman/.conda/envs/vissl_env/bin/python
INFO 2022-05-14 15:41:35,936 env.py:  50: _CE_CONDA:	
INFO 2022-05-14 15:41:35,937 env.py:  50: _CE_M:	
INFO 2022-05-14 15:41:35,939 env.py:  50: _LMFILES_:	/cvmfs/config.mila.quebec/modules/Core/Mila.lua:/cvmfs/config.mila.quebec/modules/Core/gcc/7.4.0.lua:/cvmfs/config.mila.quebec/modules/Core/anaconda/3.lua
INFO 2022-05-14 15:41:35,940 env.py:  50: _ModuleTable001_:	X01vZHVsZVRhYmxlXz17WyJNVHZlcnNpb24iXT0zLFsiY19yZWJ1aWxkVGltZSJdPWZhbHNlLFsiY19zaG9ydFRpbWUiXT1mYWxzZSxkZXB0aFQ9e30sZmFtaWx5PXt9LG1UPXtNaWxhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL01pbGEubHVhIixbImZ1bGxOYW1lIl09Ik1pbGEiLFsibG9hZE9yZGVyIl09MSxwcm9wVD17bG1vZD17WyJzdGlja3kiXT0xLH0sfSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJNaWxhIix9LGFuYWNvbmRhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL2FuYWNvbmRhLzMubHVhIixbImZ1bGxOYW1lIl09ImFuYWNvbmRh
INFO 2022-05-14 15:41:35,941 env.py:  50: _ModuleTable002_:	LzMiLFsibG9hZE9yZGVyIl09Myxwcm9wVD17fSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJhbmFjb25kYS8zIix9LGdjYz17WyJmbiJdPSIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29yZS9nY2MvNy40LjAubHVhIixbImZ1bGxOYW1lIl09ImdjYy83LjQuMCIsWyJsb2FkT3JkZXIiXT0yLHByb3BUPXtsbW9kPXtbInN0aWNreSJdPTEsfSx9LFsic3RhY2tEZXB0aCJdPTAsWyJzdGF0dXMiXT0iYWN0aXZlIixbInVzZXJOYW1lIl09ImdjYy83LjQuMCIsfSx9LG1wYXRoQT17Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Nv
INFO 2022-05-14 15:41:35,942 env.py:  50: _ModuleTable003_:	bXBpbGVyIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Vudmlyb25tZW50cyIsIi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9DdWRhIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL1B5dG9yY2giLCIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvVGVuc29yZmxvdyIsfSxbInN5c3RlbUJhc2VNUEFUSCJdPSIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29yZTovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29tcGlsZXI6L2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0Vudmlyb25tZW50czovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ3VkYTovY3Zt
INFO 2022-05-14 15:41:35,943 env.py:  50: _ModuleTable004_:	ZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvUHl0b3JjaDovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvVGVuc29yZmxvdyIsfQ==
INFO 2022-05-14 15:41:35,944 env.py:  50: _ModuleTable_Sz_:	4
INFO 2022-05-14 15:41:35,945 env.py:  50: __Init_Default_Modules:	1
INFO 2022-05-14 15:41:35,947 env.py:  50: __LMOD_REF_COUNT_CMAKE_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:1
INFO 2022-05-14 15:41:35,949 env.py:  50: __LMOD_REF_COUNT_CMAKE_PREFIX_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0:1
INFO 2022-05-14 15:41:35,952 env.py:  50: __LMOD_REF_COUNT_CPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/include:1
INFO 2022-05-14 15:41:35,955 env.py:  50: __LMOD_REF_COUNT_CSPYTHONPREFIXES:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3:1
INFO 2022-05-14 15:41:35,956 env.py:  50: __LMOD_REF_COUNT_LIBRARY_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib64:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/lib:1
INFO 2022-05-14 15:41:35,958 env.py:  50: __LMOD_REF_COUNT_LOADEDMODULES:	Mila:1;gcc/7.4.0:1;anaconda/3:1
INFO 2022-05-14 15:41:35,959 env.py:  50: __LMOD_REF_COUNT_MANPATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/share/man:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/gcc/7.4.0/share/man:1;/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man:1
INFO 2022-05-14 15:41:35,961 env.py:  50: __LMOD_REF_COUNT_MODULEPATH:	/cvmfs/config.mila.quebec/modules/Core:1;/cvmfs/config.mila.quebec/modules/Compiler:1;/cvmfs/config.mila.quebec/modules/Environments:1;/cvmfs/config.mila.quebec/modules/Cuda:1;/cvmfs/config.mila.quebec/modules/Pytorch:1;/cvmfs/config.mila.quebec/modules/Tensorflow:1
INFO 2022-05-14 15:41:35,962 env.py:  50: __LMOD_REF_COUNT_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/bin:1;/opt/slurm/bin:1;/sbin:1;/bin:1;/usr/sbin:1;/usr/bin:1
INFO 2022-05-14 15:41:35,963 env.py:  50: __LMOD_REF_COUNT_PKG_CONFIG_PATH:	/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/pkgconfig:1
INFO 2022-05-14 15:41:35,964 env.py:  50: __LMOD_REF_COUNT_PYTHONPATH:	/cvmfs/config.mila.quebec/etc/python.d/3.7:1
INFO 2022-05-14 15:41:35,965 env.py:  50: __LMOD_REF_COUNT__LMFILES_:	/cvmfs/config.mila.quebec/modules/Core/Mila.lua:1;/cvmfs/config.mila.quebec/modules/Core/gcc/7.4.0.lua:1;/cvmfs/config.mila.quebec/modules/Core/anaconda/3.lua:1
INFO 2022-05-14 15:41:35,966 misc.py: 161: Set start method of multiprocessing to forkserver
INFO 2022-05-14 15:41:35,967 train.py: 105: Setting seed....
INFO 2022-05-14 15:41:35,968 misc.py: 173: MACHINE SEED: 0
INFO 2022-05-14 15:41:36,065 hydra_config.py: 132: Training with config:
INFO 2022-05-14 15:41:36,075 hydra_config.py: 141: {'CHECKPOINT': {'APPEND_DISTR_RUN_ID': False,
                'AUTO_RESUME': True,
                'BACKEND': 'disk',
                'CHECKPOINT_FREQUENCY': 1,
                'CHECKPOINT_ITER_FREQUENCY': -1,
                'DIR': './checkpoints/eval_trained_swav/0',
                'LATEST_CHECKPOINT_RESUME_FILE_NUM': 1,
                'OVERWRITE_EXISTING': False,
                'USE_SYMLINK_CHECKPOINT_FOR_RESUME': False},
 'CLUSTERFIT': {'CLUSTER_BACKEND': 'faiss',
                'DATA_LIMIT': -1,
                'DATA_LIMIT_SAMPLING': {'SEED': 0},
                'FEATURES': {'DATASET_NAME': '',
                             'DATA_PARTITION': 'TRAIN',
                             'DIMENSIONALITY_REDUCTION': 0,
                             'EXTRACT': False,
                             'LAYER_NAME': '',
                             'PATH': '.',
                             'TEST_PARTITION': 'TEST'},
                'NUM_CLUSTERS': 16000,
                'NUM_ITER': 50,
                'OUTPUT_DIR': '.'},
 'DATA': {'DDP_BUCKET_CAP_MB': 25,
          'ENABLE_ASYNC_GPU_COPY': True,
          'NUM_DATALOADER_WORKERS': 4,
          'PIN_MEMORY': True,
          'TEST': {'BASE_DATASET': 'generic_ssl',
                   'BATCHSIZE_PER_REPLICA': 512,
                   'COLLATE_FUNCTION': 'multicrop_collator',
                   'COLLATE_FUNCTION_PARAMS': {},
                   'COPY_DESTINATION_DIR': '/tmp/imagenet1k/',
                   'COPY_TO_LOCAL_DISK': False,
                   'DATASET_NAMES': ['CIFAR100'],
                   'DATA_LIMIT': -1,
                   'DATA_LIMIT_SAMPLING': {'IS_BALANCED': False,
                                           'SEED': 0,
                                           'SKIP_NUM_SAMPLES': 0},
                   'DATA_PATHS': [],
                   'DATA_SOURCES': ['disk_folder'],
                   'DEFAULT_GRAY_IMG_SIZE': 224,
                   'DROP_LAST': True,
                   'ENABLE_QUEUE_DATASET': False,
                   'INPUT_KEY_NAMES': ['data'],
                   'LABEL_PATHS': [],
                   'LABEL_SOURCES': [],
                   'LABEL_TYPE': 'sample_index',
                   'MMAP_MODE': True,
                   'NEW_IMG_PATH_PREFIX': '',
                   'RANDOM_SYNTHETIC_IMAGES': False,
                   'REMOVE_IMG_PATH_PREFIX': '',
                   'TARGET_KEY_NAMES': ['label'],
                   'TRANSFORMS': [{'crop_scales': [[0.08, 1]],
                                   'name': 'ImgPilToMultiCrop',
                                   'num_crops': [2],
                                   'size_crops': [32],
                                   'total_num_crops': 2},
                                  {'name': 'RandomHorizontalFlip', 'p': 0.5},
                                  {'name': 'ImgPilColorDistortion',
                                   'strength': 1.0},
                                  {'name': 'ImgPilGaussianBlur',
                                   'p': 0.5,
                                   'radius_max': 2.0,
                                   'radius_min': 0.1},
                                  {'name': 'ToTensor'},
                                  {'mean': [0.5074, 0.4867, 0.4411],
                                   'name': 'Normalize',
                                   'std': [0.2011, 0.1987, 0.202]}],
                   'USE_DEBUGGING_SAMPLER': False,
                   'USE_STATEFUL_DISTRIBUTED_SAMPLER': False},
          'TRAIN': {'BASE_DATASET': 'generic_ssl',
                    'BATCHSIZE_PER_REPLICA': 512,
                    'COLLATE_FUNCTION': 'multicrop_collator',
                    'COLLATE_FUNCTION_PARAMS': {},
                    'COPY_DESTINATION_DIR': '/tmp/imagenet1k/',
                    'COPY_TO_LOCAL_DISK': False,
                    'DATASET_NAMES': ['CIFAR100'],
                    'DATA_LIMIT': -1,
                    'DATA_LIMIT_SAMPLING': {'IS_BALANCED': False,
                                            'SEED': 0,
                                            'SKIP_NUM_SAMPLES': 0},
                    'DATA_PATHS': [],
                    'DATA_SOURCES': ['disk_folder'],
                    'DEFAULT_GRAY_IMG_SIZE': 224,
                    'DROP_LAST': True,
                    'ENABLE_QUEUE_DATASET': False,
                    'INPUT_KEY_NAMES': ['data'],
                    'LABEL_PATHS': [],
                    'LABEL_SOURCES': [],
                    'LABEL_TYPE': 'sample_index',
                    'MMAP_MODE': True,
                    'NEW_IMG_PATH_PREFIX': '',
                    'RANDOM_SYNTHETIC_IMAGES': False,
                    'REMOVE_IMG_PATH_PREFIX': '',
                    'TARGET_KEY_NAMES': ['label'],
                    'TRANSFORMS': [{'crop_scales': [[0.08, 1]],
                                    'name': 'ImgPilToMultiCrop',
                                    'num_crops': [2],
                                    'size_crops': [32],
                                    'total_num_crops': 2},
                                   {'name': 'RandomHorizontalFlip', 'p': 0.5},
                                   {'name': 'ImgPilColorDistortion',
                                    'strength': 1.0},
                                   {'name': 'ImgPilGaussianBlur',
                                    'p': 0.5,
                                    'radius_max': 2.0,
                                    'radius_min': 0.1},
                                   {'name': 'ToTensor'},
                                   {'mean': [0.5074, 0.4867, 0.4411],
                                    'name': 'Normalize',
                                    'std': [0.2011, 0.1987, 0.202]}],
                    'USE_DEBUGGING_SAMPLER': False,
                    'USE_STATEFUL_DISTRIBUTED_SAMPLER': False}},
 'DISTRIBUTED': {'BACKEND': 'nccl',
                 'BROADCAST_BUFFERS': True,
                 'INIT_METHOD': 'tcp',
                 'MANUAL_GRADIENT_REDUCTION': False,
                 'NCCL_DEBUG': False,
                 'NCCL_SOCKET_NTHREADS': '',
                 'NUM_NODES': 1,
                 'NUM_PROC_PER_NODE': 1,
                 'RUN_ID': 'auto'},
 'EXTRACT_FEATURES': {'CHUNK_THRESHOLD': 0, 'OUTPUT_DIR': ''},
 'HOOKS': {'CHECK_NAN': True,
           'LOG_GPU_STATS': True,
           'MEMORY_SUMMARY': {'DUMP_MEMORY_ON_EXCEPTION': False,
                              'LOG_ITERATION_NUM': 0,
                              'PRINT_MEMORY_SUMMARY': True},
           'MODEL_COMPLEXITY': {'COMPUTE_COMPLEXITY': False,
                                'INPUT_SHAPE': [3, 224, 224]},
           'PERF_STATS': {'MONITOR_PERF_STATS': True,
                          'PERF_STAT_FREQUENCY': -1,
                          'ROLLING_BTIME_FREQ': -1},
           'TENSORBOARD_SETUP': {'EXPERIMENT_LOG_DIR': 'tensorboard',
                                 'FLUSH_EVERY_N_MIN': 5,
                                 'LOG_DIR': '.',
                                 'LOG_PARAMS': True,
                                 'LOG_PARAMS_EVERY_N_ITERS': 310,
                                 'LOG_PARAMS_GRADIENTS': True,
                                 'USE_TENSORBOARD': False}},
 'IMG_RETRIEVAL': {'CROP_QUERY_ROI': False,
                   'DATASET_PATH': '',
                   'DEBUG_MODE': False,
                   'EVAL_BINARY_PATH': '',
                   'EVAL_DATASET_NAME': 'Paris',
                   'FEATS_PROCESSING_TYPE': '',
                   'GEM_POOL_POWER': 4.0,
                   'IMG_SCALINGS': [1],
                   'NORMALIZE_FEATURES': True,
                   'NUM_DATABASE_SAMPLES': -1,
                   'NUM_QUERY_SAMPLES': -1,
                   'NUM_TRAINING_SAMPLES': -1,
                   'N_PCA': 512,
                   'RESIZE_IMG': 1024,
                   'SAVE_FEATURES': False,
                   'SAVE_RETRIEVAL_RANKINGS_SCORES': True,
                   'SIMILARITY_MEASURE': 'cosine_similarity',
                   'SPATIAL_LEVELS': 3,
                   'TRAIN_DATASET_NAME': 'Oxford',
                   'TRAIN_PCA_WHITENING': True,
                   'USE_DISTRACTORS': False,
                   'WHITEN_IMG_LIST': ''},
 'LOG_FREQUENCY': 1,
 'LOSS': {'CrossEntropyLoss': {'ignore_index': -1},
          'barlow_twins_loss': {'embedding_dim': 8192,
                                'lambda_': 0.0051,
                                'scale_loss': 0.024},
          'bce_logits_multiple_output_single_target': {'normalize_output': False,
                                                       'reduction': 'none',
                                                       'world_size': 1},
          'cross_entropy_multiple_output_single_target': {'ignore_index': -1,
                                                          'normalize_output': False,
                                                          'reduction': 'mean',
                                                          'temperature': 1.0,
                                                          'weight': None},
          'deepclusterv2_loss': {'BATCHSIZE_PER_REPLICA': 256,
                                 'DROP_LAST': True,
                                 'kmeans_iters': 10,
                                 'memory_params': {'crops_for_mb': [0],
                                                   'embedding_dim': 128},
                                 'num_clusters': [3000, 3000, 3000],
                                 'num_crops': 2,
                                 'num_train_samples': -1,
                                 'temperature': 0.1},
          'dino_loss': {'crops_for_teacher': [0, 1],
                        'ema_center': 0.9,
                        'momentum': 0.996,
                        'normalize_last_layer': True,
                        'output_dim': 65536,
                        'student_temp': 0.1,
                        'teacher_temp_max': 0.07,
                        'teacher_temp_min': 0.04,
                        'teacher_temp_warmup_iters': 37500},
          'moco_loss': {'embedding_dim': 128,
                        'momentum': 0.999,
                        'queue_size': 65536,
                        'temperature': 0.2},
          'multicrop_simclr_info_nce_loss': {'buffer_params': {'effective_batch_size': 4096,
                                                               'embedding_dim': 128,
                                                               'world_size': 64},
                                             'num_crops': 2,
                                             'temperature': 0.1},
          'name': 'swav_loss',
          'nce_loss_with_memory': {'loss_type': 'nce',
                                   'loss_weights': [1.0],
                                   'memory_params': {'embedding_dim': 128,
                                                     'memory_size': -1,
                                                     'momentum': 0.5,
                                                     'norm_init': True,
                                                     'update_mem_on_forward': True},
                                   'negative_sampling_params': {'num_negatives': 16000,
                                                                'type': 'random'},
                                   'norm_constant': -1,
                                   'norm_embedding': True,
                                   'num_train_samples': -1,
                                   'temperature': 0.07,
                                   'update_mem_with_emb_index': -100},
          'simclr_info_nce_loss': {'buffer_params': {'effective_batch_size': 4096,
                                                     'embedding_dim': 128,
                                                     'world_size': 64},
                                   'temperature': 0.1},
          'swav_loss': {'crops_for_assign': [0, 1],
                        'embedding_dim': 128,
                        'epsilon': 0.05,
                        'normalize_last_layer': True,
                        'num_crops': 2,
                        'num_iters': 3,
                        'num_prototypes': [30],
                        'output_dir': './checkpoints/eval_trained_swav/0',
                        'queue': {'local_queue_length': 0,
                                  'queue_length': 0,
                                  'start_iter': 0},
                        'temp_hard_assignment_iters': 0,
                        'temperature': 0.5,
                        'use_double_precision': False},
          'swav_momentum_loss': {'crops_for_assign': [0, 1],
                                 'embedding_dim': 128,
                                 'epsilon': 0.05,
                                 'momentum': 0.99,
                                 'momentum_eval_mode_iter_start': 0,
                                 'normalize_last_layer': True,
                                 'num_crops': 2,
                                 'num_iters': 3,
                                 'num_prototypes': [3000],
                                 'queue': {'local_queue_length': 0,
                                           'queue_length': 0,
                                           'start_iter': 0},
                                 'temperature': 0.1,
                                 'use_double_precision': False}},
 'MACHINE': {'DEVICE': 'gpu'},
 'METERS': {'accuracy_list_meter': {'meter_names': [],
                                    'num_meters': 1,
                                    'topk_values': [1]},
            'enable_training_meter': True,
            'mean_ap_list_meter': {'max_cpu_capacity': -1,
                                   'meter_names': [],
                                   'num_classes': 9605,
                                   'num_meters': 1},
            'model_output_mask': False,
            'name': '',
            'names': [],
            'precision_at_k_list_meter': {'meter_names': [],
                                          'num_meters': 1,
                                          'topk_values': [1]},
            'recall_at_k_list_meter': {'meter_names': [],
                                       'num_meters': 1,
                                       'topk_values': [1]}},
 'MODEL': {'ACTIVATION_CHECKPOINTING': {'NUM_ACTIVATION_CHECKPOINTING_SPLITS': 2,
                                        'USE_ACTIVATION_CHECKPOINTING': False},
           'AMP_PARAMS': {'AMP_ARGS': {'opt_level': 'O1'},
                          'AMP_TYPE': 'apex',
                          'USE_AMP': False},
           'BASE_MODEL_NAME': 'multi_input_output_model',
           'CUDA_CACHE': {'CLEAR_CUDA_CACHE': False, 'CLEAR_FREQ': 100},
           'FEATURE_EVAL_SETTINGS': {'EVAL_MODE_ON': True,
                                     'EVAL_TRUNK_AND_HEAD': False,
                                     'EXTRACT_TRUNK_FEATURES_ONLY': False,
                                     'FREEZE_TRUNK_AND_HEAD': False,
                                     'FREEZE_TRUNK_ONLY': False,
                                     'LINEAR_EVAL_FEAT_POOL_OPS_MAP': [],
                                     'SHOULD_FLATTEN_FEATS': True},
           'FSDP_CONFIG': {'AUTO_WRAP_THRESHOLD': 0,
                           'bucket_cap_mb': 0,
                           'clear_autocast_cache': True,
                           'compute_dtype': torch.float32,
                           'flatten_parameters': True,
                           'fp32_reduce_scatter': False,
                           'mixed_precision': True,
                           'verbose': True},
           'GRAD_CLIP': {'MAX_NORM': 1, 'NORM_TYPE': 2, 'USE_GRAD_CLIP': False},
           'HEAD': {'BATCHNORM_EPS': 1e-05,
                    'BATCHNORM_MOMENTUM': 0.1,
                    'PARAMS': [['swav_head',
                                {'dims': [512, 512, 128],
                                 'num_clusters': [30],
                                 'use_bn': True}]],
                    'PARAMS_MULTIPLIER': 1.0},
           'INPUT_TYPE': 'rgb',
           'MULTI_INPUT_HEAD_MAPPING': [],
           'NON_TRAINABLE_PARAMS': [],
           'SHARDED_DDP_SETUP': {'USE_SDP': False, 'reduce_buffer_size': -1},
           'SINGLE_PASS_EVERY_CROP': False,
           'SYNC_BN_CONFIG': {'CONVERT_BN_TO_SYNC_BN': False,
                              'GROUP_SIZE': -1,
                              'SYNC_BN_TYPE': 'pytorch'},
           'TEMP_FROZEN_PARAMS_ITER_MAP': [['module.heads.0.prototypes0.weight',
                                            900]],
           'TRUNK': {'CONVIT': {'CLASS_TOKEN_IN_LOCAL_LAYERS': False,
                                'LOCALITY_DIM': 10,
                                'LOCALITY_STRENGTH': 1.0,
                                'N_GPSA_LAYERS': 10,
                                'USE_LOCAL_INIT': True},
                     'EFFICIENT_NETS': {},
                     'NAME': 'resnet',
                     'REGNET': {},
                     'RESNETS': {'BLOCK': 'BasicBlock',
                                 'CONV1_KERNEL': 3,
                                 'CONV1_PADDING': 1,
                                 'CONV1_STRIDE': 1,
                                 'DEPTH': 18,
                                 'GROUPNORM_GROUPS': 32,
                                 'GROUPS': 1,
                                 'LAYER4_STRIDE': 2,
                                 'MAXPOOL': False,
                                 'NORM': 'BatchNorm',
                                 'STANDARDIZE_CONVOLUTIONS': False,
                                 'WIDTH_MULTIPLIER': 1,
                                 'WIDTH_PER_GROUP': 64,
                                 'ZERO_INIT_RESIDUAL': False},
                     'VISION_TRANSFORMERS': {'ATTENTION_DROPOUT_RATE': 0,
                                             'CLASSIFIER': 'token',
                                             'DROPOUT_RATE': 0,
                                             'DROP_PATH_RATE': 0,
                                             'HIDDEN_DIM': 768,
                                             'IMAGE_SIZE': 224,
                                             'MLP_DIM': 3072,
                                             'NUM_HEADS': 12,
                                             'NUM_LAYERS': 12,
                                             'PATCH_SIZE': 16,
                                             'QKV_BIAS': False,
                                             'QK_SCALE': False,
                                             'name': None},
                     'XCIT': {'ATTENTION_DROPOUT_RATE': 0,
                              'DROPOUT_RATE': 0,
                              'DROP_PATH_RATE': 0.05,
                              'ETA': 1,
                              'HIDDEN_DIM': 384,
                              'IMAGE_SIZE': 224,
                              'NUM_HEADS': 8,
                              'NUM_LAYERS': 12,
                              'PATCH_SIZE': 16,
                              'QKV_BIAS': True,
                              'QK_SCALE': False,
                              'TOKENS_NORM': True,
                              'name': None}},
           'WEIGHTS_INIT': {'APPEND_PREFIX': '',
                            'PARAMS_FILE': '',
                            'REMOVE_PREFIX': '',
                            'SKIP_LAYERS': ['num_batches_tracked'],
                            'STATE_DICT_KEY_NAME': 'classy_state_dict'},
           '_MODEL_INIT_SEED': 0},
 'MONITORING': {'MONITOR_ACTIVATION_STATISTICS': 0},
 'MULTI_PROCESSING_METHOD': 'forkserver',
 'NEAREST_NEIGHBOR': {'L2_NORM_FEATS': False, 'SIGMA': 0.1, 'TOPK': 200},
 'OPTIMIZER': {'betas': [0.9, 0.999],
               'construct_single_param_group_only': False,
               'head_optimizer_params': {'use_different_lr': False,
                                         'use_different_wd': False,
                                         'weight_decay': 1e-06},
               'larc_config': {'clip': False,
                               'eps': 1e-08,
                               'trust_coefficient': 0.001},
               'momentum': 0.9,
               'name': 'sgd',
               'nesterov': False,
               'non_regularized_parameters': [],
               'num_epochs': 1,
               'param_schedulers': {'lr': {'auto_lr_scaling': {'auto_scale': False,
                                                               'base_lr_batch_size': 256,
                                                               'base_value': 0.1,
                                                               'scaling_type': 'linear'},
                                           'end_value': 0.0006,
                                           'interval_scaling': [],
                                           'lengths': [],
                                           'milestones': [30, 60],
                                           'name': 'cosine',
                                           'schedulers': [],
                                           'start_value': 0.06,
                                           'update_interval': 'epoch',
                                           'value': 0.1,
                                           'values': [0.1, 0.01, 0.001]},
                                    'lr_head': {'auto_lr_scaling': {'auto_scale': False,
                                                                    'base_lr_batch_size': 256,
                                                                    'base_value': 0.1,
                                                                    'scaling_type': 'linear'},
                                                'end_value': 0.0006,
                                                'interval_scaling': [],
                                                'lengths': [],
                                                'milestones': [30, 60],
                                                'name': 'cosine',
                                                'schedulers': [],
                                                'start_value': 0.06,
                                                'update_interval': 'epoch',
                                                'value': 0.1,
                                                'values': [0.1, 0.01, 0.001]}},
               'regularize_bias': True,
               'regularize_bn': False,
               'use_larc': True,
               'use_zero': False,
               'weight_decay': 1e-06},
 'PROFILING': {'MEMORY_PROFILING': {'TRACK_BY_LAYER_MEMORY': False},
               'NUM_ITERATIONS': 10,
               'OUTPUT_FOLDER': '.',
               'PROFILED_RANKS': [0, 1],
               'RUNTIME_PROFILING': {'LEGACY_PROFILER': False,
                                     'PROFILE_CPU': True,
                                     'PROFILE_GPU': True,
                                     'USE_PROFILER': False},
               'START_ITERATION': 0,
               'STOP_TRAINING_AFTER_PROFILING': False,
               'WARMUP_ITERATIONS': 0},
 'REPRODUCIBILITY': {'CUDDN_DETERMINISTIC': False},
 'SEED_VALUE': 0,
 'SLURM': {'ADDITIONAL_PARAMETERS': {},
           'COMMENT': 'vissl job',
           'CONSTRAINT': '',
           'LOG_FOLDER': '.',
           'MEM_GB': 250,
           'NAME': 'vissl',
           'NUM_CPU_PER_PROC': 8,
           'PARTITION': '',
           'PORT_ID': 40050,
           'TIME_HOURS': 72,
           'TIME_MINUTES': 0,
           'USE_SLURM': False},
 'SVM': {'cls_list': [],
         'costs': {'base': -1.0,
                   'costs_list': [0.1, 0.01],
                   'power_range': [4, 20]},
         'cross_val_folds': 3,
         'dual': True,
         'force_retrain': False,
         'loss': 'squared_hinge',
         'low_shot': {'dataset_name': 'voc',
                      'k_values': [1, 2, 4, 8, 16, 32, 64, 96],
                      'sample_inds': [1, 2, 3, 4, 5]},
         'max_iter': 2000,
         'normalize': True,
         'penalty': 'l2'},
 'TEST_EVERY_NUM_EPOCH': 1,
 'TEST_MODEL': True,
 'TEST_ONLY': True,
 'TRAINER': {'TASK_NAME': 'self_supervision_task',
             'TRAIN_STEP_NAME': 'standard_train_step'},
 'VERBOSE': False,
 'WEIGHTS_INIT': {'PARAMS_FILE': './checkpoints/trained_swav/0/model_phase100.torch',
                  'STATE_DICT_KEY_NAME': 'classy_state_dict'}}
INFO 2022-05-14 15:41:53,413 train.py: 117: System config:
-------------------  ---------------------------------------------------------------------------------------------------------------
sys.platform         linux
Python               3.8.13 (default, Mar 28 2022, 11:38:47) [GCC 7.5.0]
numpy                1.19.5
Pillow               9.0.1
vissl                0.1.6 @/home/mila/r/rajkuman/mina/mphil-vissl/vissl
GPU available        True
GPU 0                Tesla V100-SXM2-32GB-LS
CUDA_HOME            None
torchvision          0.9.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/torchvision
hydra                1.0.7 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/hydra_core-1.0.7-py3.8.egg/hydra
classy_vision        0.7.0.dev @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/classy_vision
tensorboard          2.9.0
apex                 0.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/apex
PyTorch              1.8.1 @/home/mila/r/rajkuman/.conda/envs/vissl_env/lib/python3.8/site-packages/torch
PyTorch debug build  False
-------------------  ---------------------------------------------------------------------------------------------------------------
PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v1.7.0 (Git Hash 7aed236906b1f7a05c0917e5257a1af05e9ff683)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 10.2
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_37,code=compute_37
  - CuDNN 7.6.5
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=10.2, CUDNN_VERSION=7.6.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.8.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, 

CPU info:
-------------------  -----------------------------------------
Architecture         x86_64
CPU op-mode(s)       32-bit, 64-bit
Byte Order           Little Endian
CPU(s)               80
On-line CPU(s) list  0-79
Thread(s) per core   2
Core(s) per socket   20
Socket(s)            2
NUMA node(s)         2
Vendor ID            GenuineIntel
CPU family           6
Model                79
Model name           Intel(R) Xeon(R) CPU E5-2698 v4 @ 2.20GHz
Stepping             1
CPU MHz              2693.942
CPU max MHz          3600.0000
CPU min MHz          1200.0000
BogoMIPS             4389.95
Virtualization       VT-x
L1d cache            32K
L1i cache            32K
L2 cache             256K
L3 cache             51200K
NUMA node0 CPU(s)    0-19,40-59
NUMA node1 CPU(s)    20-39,60-79
-------------------  -----------------------------------------
INFO 2022-05-14 15:41:53,422 trainer_main.py: 112: Using Distributed init method: tcp://localhost:42071, world_size: 1, rank: 0
INFO 2022-05-14 15:41:53,430 distributed_c10d.py: 187: Added key: store_based_barrier_key:1 to store for rank: 0
INFO 2022-05-14 15:41:53,432 trainer_main.py: 130: | initialized host mila03.server.mila.quebec as rank 0 (0)
INFO 2022-05-14 15:42:05,300 train_task.py: 181: Not using Automatic Mixed Precision
INFO 2022-05-14 15:42:05,302 train_task.py: 455: Building model....
INFO 2022-05-14 15:42:05,304 resnext.py:  66: ResNeXT trunk, supports activation checkpointing. Deactivated
INFO 2022-05-14 15:42:05,305 resnext.py:  93: Building model: ResNeXt18-1x64d-w1-BatchNorm2d
INFO 2022-05-14 15:42:05,694 train_task.py: 656: Broadcast model BN buffers from primary on every forward pass
INFO 2022-05-14 15:42:05,695 classification_task.py: 387: Synchronized Batch Normalization is disabled
INFO 2022-05-14 15:42:05,716 optimizer_helper.py: 293: 
Trainable params: 67, 
Non-Trainable params: 0, 
Trunk Regularized Parameters: 20, 
Trunk Unregularized Parameters 40, 
Head Regularized Parameters: 5, 
Head Unregularized Parameters: 2 
Remaining Regularized Parameters: 0 
Remaining Unregularized Parameters: 0
INFO 2022-05-14 15:42:05,722 img_pil_color_distortion.py:  56: ImgPilColorDistortion | Using strength: 1.0
INFO 2022-05-14 15:42:05,728 ssl_dataset.py: 156: Rank: 0 split: TEST Data files:
['data/CIFAR-100-dataset/test']
INFO 2022-05-14 15:42:05,730 ssl_dataset.py: 159: Rank: 0 split: TEST Label files:
['data/CIFAR-100-dataset/test']
INFO 2022-05-14 15:42:06,187 disk_dataset.py:  86: Loaded 10000 samples from folder data/CIFAR-100-dataset/test
INFO 2022-05-14 15:42:06,188 misc.py: 161: Set start method of multiprocessing to forkserver
INFO 2022-05-14 15:42:06,189 __init__.py: 126: Created the Distributed Sampler....
INFO 2022-05-14 15:42:06,190 __init__.py: 101: Distributed Sampler config:
{'num_replicas': 1, 'rank': 0, 'epoch': 0, 'num_samples': 10000, 'total_size': 10000, 'shuffle': True, 'seed': 0}
INFO 2022-05-14 15:42:06,192 __init__.py: 215: Wrapping the dataloader to async device copies
INFO 2022-05-14 15:42:06,193 train_task.py: 384: Building loss...
INFO 2022-05-14 15:42:06,196 trainer_main.py: 268: Training 1 epochs
INFO 2022-05-14 15:42:06,196 trainer_main.py: 269: One epoch = 19 iterations.
INFO 2022-05-14 15:42:06,197 trainer_main.py: 270: Total 10000 samples in one epoch
INFO 2022-05-14 15:42:06,198 trainer_main.py: 276: Total 19 iterations for training
INFO 2022-05-14 15:42:06,385 logger.py:  84: Sat May 14 15:42:06 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.82.01    Driver Version: 470.82.01    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla V100-SXM2...  Off  | 00000000:8A:00.0 Off |                    0 |
| N/A   30C    P0    47W / 163W |   1202MiB / 32510MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A     31323      C   python                           1199MiB |
+-----------------------------------------------------------------------------+

INFO 2022-05-14 15:42:06,388 trainer_main.py: 173: Model is:
 Classy <class 'vissl.models.base_ssl_model.BaseSSLMultiInputOutputModel'>:
BaseSSLMultiInputOutputModel(
  (_heads): ModuleDict()
  (trunk): ResNeXt(
    (_feature_blocks): ModuleDict(
      (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv1_relu): ReLU(inplace=True)
      (maxpool): Identity()
      (layer1): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
        (1): BasicBlock(
          (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer2): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer3): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
            (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (layer4): Sequential(
        (0): BasicBlock(
          (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(<SUPPORTED_L4_STRIDE.two: 2>, <SUPPORTED_L4_STRIDE.two: 2>), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (downsample): Sequential(
            (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(<SUPPORTED_L4_STRIDE.two: 2>, <SUPPORTED_L4_STRIDE.two: 2>), bias=False)
            (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          )
        )
        (1): BasicBlock(
          (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
          (relu): ReLU(inplace=True)
          (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
          (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        )
      )
      (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
      (flatten): Flatten()
    )
  )
  (heads): ModuleList(
    (0): SwAVPrototypesHead(
      (projection_head): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
        (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (2): ReLU(inplace=True)
        (3): Linear(in_features=512, out_features=128, bias=True)
      )
      (prototypes0): Linear(in_features=128, out_features=30, bias=False)
    )
  )
)
INFO 2022-05-14 15:42:06,389 trainer_main.py: 174: Loss is: { 'embedding_dim': 128,
  'epsilon': 0.05,
  'local_queue_length': 0,
  'name': 'SwAVLoss',
  'nmb_sinkhornknopp_iters': 3,
  'num_crops': 2,
  'num_prototypes': [30],
  'temp_hard_assignment_iters': 0,
  'temperature': 0.5,
  'use_double_precision': False}
INFO 2022-05-14 15:42:06,389 trainer_main.py: 175: Starting training....
INFO 2022-05-14 15:42:06,391 __init__.py: 101: Distributed Sampler config:
{'num_replicas': 1, 'rank': 0, 'epoch': 0, 'num_samples': 10000, 'total_size': 10000, 'shuffle': True, 'seed': 0}
INFO 2022-05-14 15:42:18,464 distributed_launcher.py: 168: All Done!
INFO 2022-05-14 15:42:18,465 logger.py:  73: Shutting down loggers...
